<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title>zlog User&#8217;s Guide</title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.tug.org/tex4ht/)"> 
<!-- html --> 
<meta name="src" content="UsersGuide-EN.tex"> 
<link rel="stylesheet" type="text/css" href="UsersGuide-EN.css"> 
</head><body 
>
   <div class="maketitle">
                                                                                  
                                                                                  
                                                                                  
                                                                                  

<h2 class="titleHead">zlog<span class="thank-mark"><a 
href="#tk-1">*</a></span> User&#8217;s Guide</h2>
 <div class="author" ><span 
class="ecrm-1440">Hardy Simpson</span><span class="thank-mark"><a 
href="#tk-2"><span 
class="cmsy-10x-x-144">&#8224;</span></a></span><span class="thank-mark"><a 
href="#tk-3"><span 
class="cmsy-10x-x-144">&#8225;</span></a></span></div><br />
<div class="date" ><span 
class="ecrm-1440">February 20, 2018</span></div>
   <div class="thanks" ><br /><a 
 id="tk-1"></a><span class="thank-mark"><span 
class="cmsy-10x-x-120">*</span></span>A single spark can start a prairie fire &#8211; Mao Zedong<br /><a 
 id="tk-2"></a><span class="thank-mark"><span 
class="cmsy-10x-x-120">&#8224;</span></span>This Guide is for zlog v1.2.*<br /><a 
 id="tk-3"></a><span class="thank-mark"><span 
class="cmsy-10x-x-120">&#8225;</span></span>If
you have comments or error corrections, post <a 
href="https://github.com/HardySimpson/zlog/issues/new" >a issue</a> on github, or write email to
<a 
href="mailto:HardySimpson1984@gmail.com" >HardySimpson1984@gmail.com</a></div>
                                                                                  
                                                                                  
   </div>
                                                                                  
                                                                                  
   <h2 class="likechapterHead"><a 
 id="x1-1000"></a>Contents</h2> <div class="tableofcontents">
   <span class="chapterToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">What is zlog?</a></span>
<br />   &#x00A0;<span class="sectionToc" >1.1 <a 
href="#x1-30001.1" id="QQ2-1-3">Compatibility Notes</a></span>
<br />   &#x00A0;<span class="sectionToc" >1.2 <a 
href="#x1-40001.2" id="QQ2-1-4">zlog 1.2 Release Notes</a></span>
<br />   <span class="chapterToc" >2 <a 
href="#x1-50002" id="QQ2-1-5">What zlog is not</a></span>
<br />   <span class="chapterToc" >3 <a 
href="#x1-60003" id="QQ2-1-6">Hello World</a></span>
<br />   &#x00A0;<span class="sectionToc" >3.1 <a 
href="#x1-70003.1" id="QQ2-1-7">Build and Installation zlog</a></span>
<br />   &#x00A0;<span class="sectionToc" >3.2 <a 
href="#x1-80003.2" id="QQ2-1-8">Call and Link zlog in User&#8217;s application </a></span>
<br />   &#x00A0;<span class="sectionToc" >3.3 <a 
href="#x1-90003.3" id="QQ2-1-9">Hello World Example</a></span>
<br />   &#x00A0;<span class="sectionToc" >3.4 <a 
href="#x1-100003.4" id="QQ2-1-10">Simpler Hello World Example</a></span>
<br />   <span class="chapterToc" >4 <a 
href="#x1-110004" id="QQ2-1-11">Syslog model</a></span>
<br />   &#x00A0;<span class="sectionToc" >4.1 <a 
href="#x1-120004.1" id="QQ2-1-12">Category, Rule and Format</a></span>
<br />   &#x00A0;<span class="sectionToc" >4.2 <a 
href="#x1-130004.2" id="QQ2-1-13">Differences between syslog model and log4j model</a></span>
<br />   &#x00A0;<span class="sectionToc" >4.3 <a 
href="#x1-140004.3" id="QQ2-1-14">Expand syslog model</a></span>
<br />   <span class="chapterToc" >5 <a 
href="#x1-150005" id="QQ2-1-15">Configure File</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.1 <a 
href="#x1-160005.1" id="QQ2-1-16">Global</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.2 <a 
href="#x1-170005.2" id="QQ2-1-17">Levels</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.3 <a 
href="#x1-180005.3" id="QQ2-1-18">Formats</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.4 <a 
href="#x1-190005.4" id="QQ2-1-19">Conversion pattern</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.4.1 <a 
href="#x1-200005.4.1" id="QQ2-1-20">Conversion Characters</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.4.2 <a 
href="#x1-210005.4.2" id="QQ2-1-21">Format Modifier </a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.4.3 <a 
href="#x1-220005.4.3" id="QQ2-1-22">Time Character</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.5 <a 
href="#x1-230005.5" id="QQ2-1-23">Rules</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.5.1 <a 
href="#x1-240005.5.1" id="QQ2-1-24">Level Matching</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.5.2 <a 
href="#x1-250005.5.2" id="QQ2-1-25">Category Matching</a></span>
<br />   &#x00A0;&#x00A0;<span class="subsectionToc" >5.5.3 <a 
href="#x1-260005.5.3" id="QQ2-1-26">Output Action</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.6 <a 
href="#x1-270005.6" id="QQ2-1-27">Rotation</a></span>
<br />   &#x00A0;<span class="sectionToc" >5.7 <a 
href="#x1-280005.7" id="QQ2-1-28">Configure File Tools</a></span>
<br />   <span class="chapterToc" >6 <a 
href="#x1-290006" id="QQ2-1-29">zlog API</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.1 <a 
href="#x1-300006.1" id="QQ2-1-30">initialize and finish</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.2 <a 
href="#x1-310006.2" id="QQ2-1-31">category operation</a></span>
                                                                                  
                                                                                  
<br />   &#x00A0;<span class="sectionToc" >6.3 <a 
href="#x1-320006.3" id="QQ2-1-32">log functions and macros</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.4 <a 
href="#x1-330006.4" id="QQ2-1-33">MDC operation</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.5 <a 
href="#x1-340006.5" id="QQ2-1-34">dzlog API</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.6 <a 
href="#x1-350006.6" id="QQ2-1-35">User-defined Output</a></span>
<br />   &#x00A0;<span class="sectionToc" >6.7 <a 
href="#x1-360006.7" id="QQ2-1-36">debug and profile</a></span>
<br />   <span class="chapterToc" >7 <a 
href="#x1-370007" id="QQ2-1-37">Advanced Usage</a></span>
<br />   &#x00A0;<span class="sectionToc" >7.1 <a 
href="#x1-380007.1" id="QQ2-1-38">MDC</a></span>
<br />   &#x00A0;<span class="sectionToc" >7.2 <a 
href="#x1-390007.2" id="QQ2-1-39">Profile zlog Itself</a></span>
<br />   &#x00A0;<span class="sectionToc" >7.3 <a 
href="#x1-400007.3" id="QQ2-1-40">User-defined Level</a></span>
<br />   &#x00A0;<span class="sectionToc" >7.4 <a 
href="#x1-410007.4" id="QQ2-1-41">User-defined Output</a></span>
<br />   <span class="chapterToc" >8 <a 
href="#x1-420008" id="QQ2-1-42">Epilog</a></span>
   </div>
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-20001"></a>What is zlog?</h2>
<!--l. 76--><p class="noindent" >zlog is a reliable, high-performance, thread safe, flexible, clear-model, pure C logging
library.
<!--l. 79--><p class="indent" >   Actually, in the C world there was NO good logging library for applications like
logback in java or log4cxx in c++. printf can work, but can not be redirected easily nor be
reformatted. syslog is slow and is designed for system use.
<!--l. 84--><p class="indent" >   So I wrote zlog.
<!--l. 86--><p class="indent" >   It is faster, safer and more powerful than log4c. So it can be widely used.
<!--l. 89--><p class="indent" >   zlog has these features:
      <ul class="itemize1">
      <li class="itemize">syslog model, better than log4j model
      </li>
      <li class="itemize">log format customization
      </li>
      <li class="itemize">multiple  output,  include  static  file  path,  dynamic  file  path,  stdout,  stderr,
      syslog, user-defined ouput
      </li>
      <li class="itemize">runtime with manual or automatic refresh of configuration (done safely)
      </li>
      <li class="itemize">high-performance, 250&#8217;000 logs/second on my laptop, about 1000 times faster
      than syslog(3) with rsyslogd
      </li>
      <li class="itemize">user-defined log level
      </li>
      <li class="itemize">safely rotate log file under multiple-process or multiple-thread conditions
      </li>
      <li class="itemize">accurate to microseconds
      </li>
      <li class="itemize">dzlog, a default category log API for easy use
      </li>
      <li class="itemize">MDC, a log4j style key-value map
                                                                                  
                                                                                  
      </li>
      <li class="itemize">self debuggable, can output zlog&#8217;s self debug and error log at runtime
      </li>
      <li class="itemize">Does not depend on any other 3rd party library, just base on POSIX system
      (including pthread) and a C99 compliant vsnprintf.</li></ul>
<!--l. 107--><p class="noindent" >Links:
<!--l. 109--><p class="indent" >   Homepage: <a 
href="http://hardysimpson.github.com/zlog" >http://hardysimpson.github.com/zlog</a>
<!--l. 111--><p class="indent" >   Downloads: <a 
href="https://github.com/HardySimpson/zlog/releases" >https://github.com/HardySimpson/zlog/releases</a>
<!--l. 113--><p class="indent" >   Author&#8217;s Email: <a 
href="mailto:HardySimpson1984@gmail.com" >HardySimpson1984@gmail.com</a>
   <h3 class="sectionHead"><span class="titlemark">1.1   </span> <a 
 id="x1-30001.1"></a>Compatibility Notes</h3>
<!--l. 116--><p class="noindent" >
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-3002x1">zlog is based on POSIX-compatible systems. I have just GNU/linux and AIX
      environments to compile, test and run zlog. Still, I think zlog will work well on
      FreeBSD, NetBSD, OpenBSD, OpenSolaris, Mac OS X etc. Test runs of zlog
      on any system are welcome.
      </li>
      <li 
  class="enumerate" id="x1-3004x2">zlog uses a feature of C99 compliant vsnprintf. That is, if the buffer size of
      destination is not long enough, vsnprintf will return the number of characters
      (not including the trailing &#8217;\0&#8217;) which would have been written to the final
      string if enough space had been available. If the vsnprintf on your system does
      not work like that, zlog can not know the right buffer size when a single log is
      longer than the buffer. Fortunately, glibc 2.1, libc on AIX, and libc on freebsd
      work correctly, while glibc 2.0 does not. In this case, user should crack zlog
      himself with a C99 compliant vsnprintf. I suggest <a 
href="http://sourceforge.net/projects/ctrio/" >ctrio</a>, or <a 
href="http://www.jhweiss.de/software/snprintf.html" >C99-snprintf</a>. The
      file buf.c should be cracked, good luck!
      </li>
      <li 
  class="enumerate" id="x1-3006x3">Some people offer versions of zlog for other platforms. Thanks!
      <!--l. 135--><p class="noindent" >auto tools version: <a 
href="https://github.com/bmanojlovic/zlog" >https://github.com/bmanojlovic/zlog</a>
      <!--l. 137--><p class="noindent" >cmake verion: <a 
href="https://github.com/lisongmin/zlog" >https://github.com/lisongmin/zlog</a>
      <!--l. 139--><p class="noindent" >windows version: <a 
href="https://github.com/lopsd07/WinZlog" >https://github.com/lopsd07/WinZlog</a></li></ol>
                                                                                  
                                                                                  
<!--l. 142--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">1.2   </span> <a 
 id="x1-40001.2"></a>zlog 1.2 Release Notes</h3>
<!--l. 143--><p class="noindent" >
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-4002x1">zlog 1.2 provides these features:
      <!--l. 146--><p class="noindent" >
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-4004x1">support for pipeline. Now zlog can send ouput log through programs like
           cronolog
           </li>
           <li 
  class="enumerate" id="x1-4006x2">Full rotation support, see <a 
href="#x1-270005.6">5.6<!--tex4ht:ref: sec:Rotation --></a>
           </li>
           <li 
  class="enumerate" id="x1-4008x3">Other code compatible details, bug fixes.</li></ol>
      </li>
      <li 
  class="enumerate" id="x1-4010x2">zlog 1.2 is binary compatible with zlog 1.0. The differences are:
      <!--l. 154--><p class="noindent" >
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-4012x1">All  zlog  macros  like  ZLOG_INFO  are  shifted  to  lowercase  versions,
           zlog_info. This big change is because I think it is easier for people to type.
           If you are using a previous version of zlog, please use a script to substitute
           all macros, and re-compile your program. Here is an example:</li></ol>
      <!--l. 161--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 161--><p class="noindent" ><span 
class="ectt-1200">sed</span><span 
class="ectt-1200">&#x00A0;-i</span><span 
class="ectt-1200">&#x00A0;-e</span><span 
class="ectt-1200">&#x00A0;&#8217;s/\b\w*ZLOG\w*\b/\L&amp;\E/g&#8217;</span><span 
class="ectt-1200">&#x00A0;aa.c</span></dd></dl>
      <!--l. 164--><p class="noindent" >
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-4014x1">Auto tools compile is abandoned. Auto tools is ugly so I dropped it. A
           simple makefile is in use, which requires gcc and gnu make. If this makefile
           does not work in your environment, you will need to write a suitable
           makefile for yourself. It should be quite easy for a geek.</li></ol>
                                                                                  
                                                                                  
      </li></ol>
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-50002"></a>What zlog is not</h2>
<!--l. 174--><p class="noindent" >The goal of zlog is to be a simple, fast log library for applications. It does not support
output like sending the log to another machine through the net or saving it to database. It
will not parse content of log and filter them.
<!--l. 179--><p class="indent" >   The reason is obvious: the library is called by an application, so all time taken by the
log library is part of the application&#8217;s time. And database inserting or log content parsing
takes a long time. These will slow down the application. These operation should be done in
a different process or on a different machine.
<!--l. 185--><p class="indent" >   If you want all these features, I recommend rsyslog, zLogFabric, Logstash. These have
independent processes to receive logs from another process or machine, and to parse and
store logs. These functions are separated from the user application.
<!--l. 190--><p class="indent" >   Now <a 
href="#x1-410007.4">7.4<!--tex4ht:ref: sec:User-defined-Output --></a> is supported by zlog. Just one output function need to be implemented: to
transfer the log to the other process or machine. The work of category matching and log
generating is left with the zlog library.
<!--l. 195--><p class="indent" >   One possibility is to write a zlog-redis client. It send logs to redis on local or remote
machines by user defined output. Then other processes can read logs from redis and write
to disk. What do you think about this idea? I will be happy to discuss it with
you.
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-60003"></a>Hello World</h2>
   <h3 class="sectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-70003.1"></a>Build and Installation zlog</h3>
<!--l. 204--><p class="noindent" >Download:<a 
href="https://github.com/HardySimpson/zlog/archive/latest-stable.tar.gz" >https://github.com/HardySimpson/zlog/archive/latest-stable.tar.gz</a>
<!--l. 205--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 205--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;tar</span><span 
class="ectt-1200">&#x00A0;-zxvf</span><span 
class="ectt-1200">&#x00A0;zlog-latest-stable.tar.gz</span>
      <!--l. 208--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cd</span><span 
class="ectt-1200">&#x00A0;zlog-latest-stable/</span>
      <!--l. 210--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 212--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;sudo</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;install</span>
      <!--l. 214--><p class="noindent" ><span 
class="ectt-1200">or</span>
      <!--l. 216--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;sudo</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;PREFIX=/usr/local/</span><span 
class="ectt-1200">&#x00A0;install</span></dd></dl>
<!--l. 218--><p class="noindent" >PREFIX indicates where zlog is installed. After installation, change system settings to make
sure your program can find the zlog library
<!--l. 220--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 220--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;sudo</span><span 
class="ectt-1200">&#x00A0;vi</span><span 
class="ectt-1200">&#x00A0;/etc/ld.so.conf</span>
      <!--l. 223--><p class="noindent" ><span 
class="ectt-1200">/usr/local/lib</span>
      <!--l. 225--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;sudo</span><span 
class="ectt-1200">&#x00A0;ldconfig</span></dd></dl>
<!--l. 227--><p class="noindent" >Before running a real program, make sure libzlog.so is in the directory where the system&#8217;s
dynamic lib loader can find it. The commands mentioned above are for linux. Other
systems will need a similar set of actions.
      <ul class="itemize1">
      <li class="itemize">Beside the normal make, these are also available:</li></ul>
<!--l. 233--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 233--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;32bit</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;32bit</span><span 
class="ectt-1200">&#x00A0;version</span><span 
class="ectt-1200">&#x00A0;on</span><span 
class="ectt-1200">&#x00A0;64bit</span><span 
class="ectt-1200">&#x00A0;machine,</span><span 
class="ectt-1200">&#x00A0;libc6-dev-i386</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;needed</span>
                                                                                  
                                                                                  
      <!--l. 236--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;noopt</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;without</span><span 
class="ectt-1200">&#x00A0;gcc</span><span 
class="ectt-1200">&#x00A0;optimization</span>
      <!--l. 238--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;doc</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;lyx</span><span 
class="ectt-1200">&#x00A0;and</span><span 
class="ectt-1200">&#x00A0;hevea</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;needed</span>
      <!--l. 240--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;make</span><span 
class="ectt-1200">&#x00A0;test</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;test</span><span 
class="ectt-1200">&#x00A0;code,</span><span 
class="ectt-1200">&#x00A0;which</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;also</span><span 
class="ectt-1200">&#x00A0;good</span><span 
class="ectt-1200">&#x00A0;example</span><span 
class="ectt-1200">&#x00A0;for</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
      <ul class="itemize1">
      <li class="itemize">makefile of zlog is written in gnu make style. So if your platform is not linux,
      install a gnu make and gcc before trying to build zlog. Another way is to write
      a makefile in your platform&#8217;s make style. This should be quite easy as zlog is
      not complicated.</li></ul>
<!--l. 249--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-80003.2"></a>Call and Link zlog in User&#8217;s application </h3>
<!--l. 251--><p class="noindent" >To use zlog, add one line to the source c file or cpp file:
<!--l. 252--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 252--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span></dd></dl>
<!--l. 255--><p class="noindent" >zlog needs the pthread library. The link command is:
<!--l. 256--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 256--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cc</span><span 
class="ectt-1200">&#x00A0;-c</span><span 
class="ectt-1200">&#x00A0;-o</span><span 
class="ectt-1200">&#x00A0;app.o</span><span 
class="ectt-1200">&#x00A0;app.c</span><span 
class="ectt-1200">&#x00A0;-I/usr/local/include</span>
      <!--l. 259--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;-I[where</span><span 
class="ectt-1200">&#x00A0;zlog.h</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;put]</span>
      <!--l. 261--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cc</span><span 
class="ectt-1200">&#x00A0;-o</span><span 
class="ectt-1200">&#x00A0;app</span><span 
class="ectt-1200">&#x00A0;app.o</span><span 
class="ectt-1200">&#x00A0;-L/usr/local/lib</span><span 
class="ectt-1200">&#x00A0;-lzlog</span><span 
class="ectt-1200">&#x00A0;-lpthread</span>
      <!--l. 263--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;-L[where</span><span 
class="ectt-1200">&#x00A0;libzlog.so]</span></dd></dl>
<!--l. 266--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-90003.3"></a>Hello World Example</h3>
<!--l. 268--><p class="noindent" >This example can be found in $(top_builddir)/test/test_hello.c, test_hello.conf
                                                                                  
                                                                                  
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-9002x1">Write a new c source file:
      <!--l. 273--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 273--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;vi</span><span 
class="ectt-1200">&#x00A0;test_hello.c</span>
           <!--l. 276--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 278--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
           <!--l. 280--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 282--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
           <!--l. 284--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 286--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 286--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
               <!--l. 289--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*c;</span>
               <!--l. 291--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_init("test_hello.conf");</span>
               <!--l. 293--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 295--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 295--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
                   <!--l. 298--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
               <!--l. 300--><p class="noindent" ><span 
class="ectt-1200">}</span>
               <!--l. 302--><p class="noindent" ><span 
class="ectt-1200">c</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span>
               <!--l. 304--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(!c)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 306--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 306--><p class="noindent" ><span 
class="ectt-1200">printf("get</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;fail\n");</span>
                   <!--l. 309--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
                   <!--l. 311--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-2;</span></dd></dl>
               <!--l. 313--><p class="noindent" ><span 
class="ectt-1200">}</span>
                                                                                  
                                                                                  
               <!--l. 315--><p class="noindent" ><span 
class="ectt-1200">zlog_info(c,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
               <!--l. 317--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
               <!--l. 319--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
           <!--l. 321--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-9004x2">Write a configuration file in the same path as test_hello.c:
      <!--l. 325--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 325--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;vi</span><span 
class="ectt-1200">&#x00A0;test_hello.conf</span>
           <!--l. 328--><p class="noindent" ><span 
class="ectt-1200">[formats]</span>
           <!--l. 330--><p class="noindent" ><span 
class="ectt-1200">simple</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%m%n"</span>
           <!--l. 332--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
           <!--l. 334--><p class="noindent" ><span 
class="ectt-1200">my_cat.DEBUG</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;simple</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-9006x3">Compile and run it:
      <!--l. 338--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 338--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cc</span><span 
class="ectt-1200">&#x00A0;-c</span><span 
class="ectt-1200">&#x00A0;-o</span><span 
class="ectt-1200">&#x00A0;test_hello.o</span><span 
class="ectt-1200">&#x00A0;test_hello.c</span><span 
class="ectt-1200">&#x00A0;-I/usr/local/include</span>
           <!--l. 341--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cc</span><span 
class="ectt-1200">&#x00A0;-o</span><span 
class="ectt-1200">&#x00A0;test_hello</span><span 
class="ectt-1200">&#x00A0;test_hello.o</span><span 
class="ectt-1200">&#x00A0;-L/usr/local/lib</span><span 
class="ectt-1200">&#x00A0;-lzlog</span>
           <!--l. 343--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;./test_hello</span>
           <!--l. 345--><p class="noindent" ><span 
class="ectt-1200">hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
      </li></ol>
<!--l. 349--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">3.4   </span> <a 
 id="x1-100003.4"></a>Simpler Hello World Example</h3>
<!--l. 351--><p class="noindent" >This example can be found in $(top_builddir)/test/test_default.c, test_default.conf. The
source code is
<!--l. 353--><p class="noindent" >
                                                                                  
                                                                                  
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 353--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span>
      <!--l. 356--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
      <!--l. 358--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
      <!--l. 360--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 362--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 362--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
           <!--l. 365--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;dzlog_init("test_default.conf",</span><span 
class="ectt-1200">&#x00A0;"my_cat");</span>
           <!--l. 367--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 369--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 369--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
               <!--l. 372--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
           <!--l. 374--><p class="noindent" ><span 
class="ectt-1200">}</span>
           <!--l. 376--><p class="noindent" ><span 
class="ectt-1200">dzlog_info("hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
           <!--l. 378--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
           <!--l. 380--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
      <!--l. 382--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
<!--l. 384--><p class="noindent" >The configure file test_default.conf is the same as test_hello.conf, and the output of
test_default is the same as that of test_hello. The difference is that test_default uses the
dzlog API, which has a default <span 
class="ecti-1200">zlog_category_t </span>inside and is easier to use. See <a 
href="#x1-340006.5">6.5<!--tex4ht:ref: sec:dzlog-API --></a> for
more details.
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-110004"></a>Syslog model</h2>
   <h3 class="sectionHead"><span class="titlemark">4.1   </span> <a 
 id="x1-120004.1"></a>Category, Rule and Format</h3>
<!--l. 394--><p class="noindent" >In zlog, there are 3 important concepts: category, rule and format.
<!--l. 396--><p class="indent" >   Category specifies different kinds of log entries. In the zlog source code, category is a
(zlog_cateogory_t *) variable. In your program, different categories for the log entries will
distinguish them from each other.
<!--l. 401--><p class="indent" >   Format describes detail log patterns, such as: with or without time stamp, source file,
source line.
<!--l. 404--><p class="indent" >   Rule consists of category, level, output file (or other channel) and format. In brief, if
the category string in a rule in the configuration file equals the name of a category variable
in the source, then they match.
<!--l. 409--><p class="indent" >   So when this sentence in the source file is executed:
<!--l. 410--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 410--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*c;</span>
      <!--l. 413--><p class="noindent" ><span 
class="ectt-1200">c</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span>
      <!--l. 415--><p class="noindent" ><span 
class="ectt-1200">zlog_info(c,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span></dd></dl>
<!--l. 417--><p class="noindent" >zlog library uses the category name "my_cat" to match one rule in the configuration file.
That is
<!--l. 419--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 419--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 422--><p class="noindent" ><span 
class="ectt-1200">my_cat.DEBUG</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;simple</span></dd></dl>
<!--l. 424--><p class="noindent" >Then the library will check if level is correct to decide whether the log will be output or
not. As INFO&#x003E;=DEBUG the log will be output, and as the rule says, it will be
sent to stdout (standard output) in the format of simple, which is described
as
<!--l. 428--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
                                                                                  
                                                                                  
      <!--l. 428--><p class="noindent" ><span 
class="ectt-1200">[formats]</span>
      <!--l. 431--><p class="noindent" ><span 
class="ectt-1200">simple</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%m%n"</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
<!--l. 433--><p class="noindent" >Lastly, zlog will show the zlog_info() content on the screen
<!--l. 434--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 434--><p class="noindent" ><span 
class="ectt-1200">hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
<!--l. 437--><p class="noindent" >That&#8217;s the whole story. The only thing a user need to do is to write the messages. Where the
log will be output, or in which format, is done by zlog library.
<!--l. 441--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">4.2   </span> <a 
 id="x1-130004.2"></a>Differences between syslog model and log4j model</h3>
<!--l. 443--><p class="noindent" >Does zLog have anything to do with syslog? Until now, the model is more like log4j. As in
log4j, there are concepts of logger, appender and layout. The difference is that in log4j,
each logger in source code must correspond to one logger in the configuration file and has
just one definite level. One-to-one relationship is the only choice for log4j, log4cxx,
log4cpp, log4cplus log4net and etc...
<!--l. 450--><p class="indent" >   But the log4j model is NOT flexible, they invent filters to make up for it, and that
make things more worse. So let&#8217;s get back to syslog model, which has an excellent
design.
<!--l. 454--><p class="indent" >   Continuing our example from the last section, if the zlog configuration file has 2
rules:
<!--l. 456--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 456--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 459--><p class="noindent" ><span 
class="ectt-1200">my_cat.DEBUG</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;simple</span>
      <!--l. 461--><p class="noindent" ><span 
class="ectt-1200">my_cat.INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span></dd></dl>
<!--l. 463--><p class="noindent" >Then they will generate 2 log outputs to stdout:
<!--l. 464--><p class="noindent" >
                                                                                  
                                                                                  
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 464--><p class="noindent" ><span 
class="ectt-1200">hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span>
      <!--l. 467--><p class="noindent" ><span 
class="ectt-1200">2012-05-29</span><span 
class="ectt-1200">&#x00A0;10:41:36</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;[11288:test_hello.c:41]</span><span 
class="ectt-1200">&#x00A0;hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
<!--l. 469--><p class="noindent" >You see that one category in the source code corresponds to two rules in the configuration file.
Maybe log4j&#8217;s user will say, "That&#8217;s good, but 2 appender for one logger will do the same
thing". So, let&#8217;s see the next example of configure file:
<!--l. 473--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 473--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 476--><p class="noindent" ><span 
class="ectt-1200">my_cat.WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/aa.log"</span>
      <!--l. 478--><p class="noindent" ><span 
class="ectt-1200">my_cat.DEBUG</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/bb.log"</span></dd></dl>
<!--l. 480--><p class="noindent" >And the source code is:
<!--l. 481--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 481--><p class="noindent" ><span 
class="ectt-1200">zlog_info(c,</span><span 
class="ectt-1200">&#x00A0;"info,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
      <!--l. 484--><p class="noindent" ><span 
class="ectt-1200">zlog_debug(c,</span><span 
class="ectt-1200">&#x00A0;"debug,</span><span 
class="ectt-1200">&#x00A0;zlog");</span></dd></dl>
<!--l. 486--><p class="noindent" >Then, in aa.log, there is just one log
<!--l. 487--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 487--><p class="noindent" ><span 
class="ectt-1200">2012-05-29</span><span 
class="ectt-1200">&#x00A0;10:41:36</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;[11288:test_hello.c:41]</span><span 
class="ectt-1200">&#x00A0;info,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
<!--l. 490--><p class="noindent" >But in bb.log, there will be two
<!--l. 491--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 491--><p class="noindent" ><span 
class="ectt-1200">2012-05-29</span><span 
class="ectt-1200">&#x00A0;10:41:36</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;[11288:test_hello.c:41]</span><span 
class="ectt-1200">&#x00A0;info,</span><span 
class="ectt-1200">&#x00A0;zlog</span>
      <!--l. 494--><p class="noindent" ><span 
class="ectt-1200">2012-05-29</span><span 
class="ectt-1200">&#x00A0;10:41:36</span><span 
class="ectt-1200">&#x00A0;DEBUG</span><span 
class="ectt-1200">&#x00A0;[11288:test_hello.c:42]</span><span 
class="ectt-1200">&#x00A0;debug,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 496--><p class="noindent" >From this example, you see the difference. Log4j can not do it easily. In zlog, one category
may correspond to mutiple rules, and rules can have different level, output, and format
combinations. The user has an easy, clear way to filter and multi-ouput all logs on
demand.
<!--l. 501--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">4.3   </span> <a 
 id="x1-140004.3"></a>Expand syslog model</h3>
<!--l. 503--><p class="noindent" >You can see that category in zlog is more like facility in syslog. Unfortunately, facility in
sylog is an int, and the value of facility must be chosen from a limited system-defined
range. zlog does better, making it a string variable.
<!--l. 508--><p class="indent" >   In syslog, there is a special wildcard "*", which matches all facilities. It does the same
thing in zlog. "*" matches all categories. That is a convenient way to make all errors
generated by multiple components in your system redirect to one log file. Just write in the
configuration file like this:
<!--l. 513--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 513--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 516--><p class="noindent" ><span 
class="ectt-1200">*.error</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/error.log"</span></dd></dl>
<!--l. 518--><p class="noindent" >A unique feature of zlog is sub-category matching. If your source code has:
<!--l. 520--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 520--><p class="noindent" ><span 
class="ectt-1200">c</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span></dd></dl>
<!--l. 523--><p class="noindent" >And the configuration file has rules :
<!--l. 524--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 524--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 527--><p class="noindent" ><span 
class="ectt-1200">my_cat.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/my_cat.log"</span>
      <!--l. 529--><p class="noindent" ><span 
class="ectt-1200">my_.NOTICE</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/my.log"</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 531--><p class="noindent" >These 2 rules match category "c" with the name "my_cat". The wildcard "_" is the way to
represent a super category. "my_" is a super category for "my_cat" and "my_dog".
There is also another wildcard "!". See <a 
href="#x1-250005.5.2">5.5.2<!--tex4ht:ref: subsec:Category-Matching --></a> for more detail.
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-150005"></a>Configure File</h2>
<!--l. 541--><p class="noindent" >Most actions of zlog library are dependent upon the configuration file: where to output the
log, how to rotate the log files, how to format the output, etc. The configuration file uses a
domain specific language to control the library actions. Here is an example of
zlog.conf:
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 545--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;comments</span>
      <!--l. 548--><p class="noindent" ><span 
class="ectt-1200">[global]</span>
      <!--l. 550--><p class="noindent" ><span 
class="ectt-1200">strict</span><span 
class="ectt-1200">&#x00A0;init</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;true</span>
      <!--l. 552--><p class="noindent" ><span 
class="ectt-1200">reload</span><span 
class="ectt-1200">&#x00A0;conf</span><span 
class="ectt-1200">&#x00A0;period</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;1M</span>
      <!--l. 554--><p class="noindent" ><span 
class="ectt-1200">buffer</span><span 
class="ectt-1200">&#x00A0;min</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;1024</span>
      <!--l. 556--><p class="noindent" ><span 
class="ectt-1200">buffer</span><span 
class="ectt-1200">&#x00A0;max</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;2MB</span>
      <!--l. 558--><p class="noindent" ><span 
class="ectt-1200">rotate</span><span 
class="ectt-1200">&#x00A0;lock</span><span 
class="ectt-1200">&#x00A0;file</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;/tmp/zlog.lock</span>
      <!--l. 560--><p class="noindent" ><span 
class="ectt-1200">default</span><span 
class="ectt-1200">&#x00A0;format</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%d.%ms</span><span 
class="ectt-1200">&#x00A0;%-6V</span><span 
class="ectt-1200">&#x00A0;(%c:%F:%L)</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;%m%n"</span>
      <!--l. 562--><p class="noindent" ><span 
class="ectt-1200">file</span><span 
class="ectt-1200">&#x00A0;perms</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;600</span>
      <!--l. 564--><p class="noindent" ><span 
class="ectt-1200">fsync</span><span 
class="ectt-1200">&#x00A0;period</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;1K</span>
      <!--l. 566--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 568--><p class="noindent" ><span 
class="ectt-1200">[levels]</span>
      <!--l. 570--><p class="noindent" ><span 
class="ectt-1200">TRACE</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;10</span>
      <!--l. 572--><p class="noindent" ><span 
class="ectt-1200">CRIT</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;130,</span><span 
class="ectt-1200">&#x00A0;LOG_CRIT</span>
      <!--l. 574--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 576--><p class="noindent" ><span 
class="ectt-1200">[formats]</span>
      <!--l. 578--><p class="noindent" ><span 
class="ectt-1200">simple</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%m%n"</span>
      <!--l. 580--><p class="noindent" ><span 
class="ectt-1200">normal</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%d(%F</span><span 
class="ectt-1200">&#x00A0;%T)</span><span 
class="ectt-1200">&#x00A0;%m%n"</span>
      <!--l. 582--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 584--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 586--><p class="noindent" ><span 
class="ectt-1200">default.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;simple</span>
      <!--l. 588--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%12.2E(HOME)/log/%c.log",</span><span 
class="ectt-1200">&#x00A0;1MB*12;</span><span 
class="ectt-1200">&#x00A0;simple</span>
      <!--l. 590--><p class="noindent" ><span 
class="ectt-1200">my_.INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stderr;</span>
      <!--l. 592--><p class="noindent" ><span 
class="ectt-1200">my_cat.!ERROR</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/aa.log"</span>
      <!--l. 594--><p class="noindent" ><span 
class="ectt-1200">my_dog.=DEBUG</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;syslog,</span><span 
class="ectt-1200">&#x00A0;LOG_LOCAL0;</span><span 
class="ectt-1200">&#x00A0;simple</span>
      <!--l. 596--><p class="noindent" ><span 
class="ectt-1200">my_mice.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;$user_define;</span></dd></dl>
<!--l. 598--><p class="noindent" >[] means a section&#8217;s beginning, and the order of sections is fixed, using the sequence
global-levels-formats-rules.
<!--l. 601--><p class="indent" >   Note on units: when memory size or large number is needed, it is possible to specify it
in the usual form of 1k 5GB 4M and so forth:
                                                                                  
                                                                                  
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 603--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1k</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1000</span><span 
class="ectt-1200">&#x00A0;bytes</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 606--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1kb</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1024</span><span 
class="ectt-1200">&#x00A0;bytes</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 608--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1m</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1000000</span><span 
class="ectt-1200">&#x00A0;bytes</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 610--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1mb</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1024*1024</span><span 
class="ectt-1200">&#x00A0;bytes</span>
      <!--l. 612--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1g</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1000000000</span><span 
class="ectt-1200">&#x00A0;bytes</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 614--><p class="noindent" ><span 
class="ectt-1200">#</span><span 
class="ectt-1200">&#x00A0;1gb</span><span 
class="ectt-1200">&#x00A0;=&#x003E;</span><span 
class="ectt-1200">&#x00A0;1024*1024*1024</span><span 
class="ectt-1200">&#x00A0;byte</span></dd></dl>
<!--l. 616--><p class="noindent" >units are case insensitive so 1GB 1Gb 1gB are all the same.
   <h3 class="sectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-160005.1"></a>Global</h3>
<!--l. 620--><p class="noindent" >Global section begins with [global]. This section can be omitted.The syntax is
<!--l. 622--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 622--><p class="noindent" ><span 
class="ectt-1200">(key)</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;(value)</span></dd></dl>
      <ul class="itemize1">
      <li class="itemize">strict init
      <!--l. 628--><p class="noindent" >If "strict init = true&#8221;, zlog_init() will check syntax of all formats and rules
      strictly, and any error will cause zlog_init() to fail and return -1. When "strict
      init = false&#8221;, zlog_init() will ignore syntax errors for formats and rules. The
      default is true.
      </li>
      <li class="itemize">reload conf period
      <!--l. 635--><p class="noindent" >This  parameter  causes  the  zlog  library  to  reload  the  configuration  file
      automatically after a period, which is measured by number of log times per
      process. When the number reaches the value, it calls zlog_reload() internally.
      The  number  is  reset  to  zero  at  the  last  zlog_reload()  or  zlog_init().  As
      zlog_reload() is atomic, if zlog_reload() fails, zlog still runs with the current
      configuration. So reloading automatically the configuration is safe. The default
      is 0, which means never reload automatically.
                                                                                  
                                                                                  
      </li>
      <li class="itemize">buffer min
      </li>
      <li class="itemize">buffer max
      <!--l. 646--><p class="noindent" >zlog allocates a log buffer in each thread. "buffer min" indicates size of buffer
      malloc&#8217;ed at init time. While logging, if one single log&#8217;s content is longer than
      buffer size now, zlog will expand buffer automatically until "buffer max". Then,
      if the size is still longer than "buffer max", the log content will be truncated.
      If "buffer max" is 0, it means buffer size is unlimited, and each time zlog will
      expand buffer by twice its size, until the process uses all available memory. The
      value of these 2 parameters can appended with unit KB, MB or GB suffix,
      where 1024 equals 1KB. As default, "buffer min" is 1K and "buffer max" is
      2MB.
      </li>
      <li class="itemize">rotate lock file
      <!--l. 660--><p class="noindent" >This specifies a lock file for rotating a log safely in multi-process situations. zlog will
      open the file at zlog_init() with the permission of read-write. The pseudo-code for
      rotating a log file is:
      <!--l. 663--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 663--><p class="noindent" ><span 
class="ectt-1200">write(log_file,</span><span 
class="ectt-1200">&#x00A0;a_log)</span>
           <!--l. 666--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(log_file</span><span 
class="ectt-1200">&#x00A0;&#x003E;</span><span 
class="ectt-1200">&#x00A0;1M)</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 668--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 668--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(pthread_mutex_lock</span><span 
class="ectt-1200">&#x00A0;succ</span><span 
class="ectt-1200">&#x00A0;&amp;&amp;</span><span 
class="ectt-1200">&#x00A0;fcntl_lock(lock_file)</span><span 
class="ectt-1200">&#x00A0;succ)</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 671--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 671--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(log_file</span><span 
class="ectt-1200">&#x00A0;&#x003E;</span><span 
class="ectt-1200">&#x00A0;1M)</span><span 
class="ectt-1200">&#x00A0;rotate(log_file);</span>
                   <!--l. 674--><p class="noindent" ><span 
class="ectt-1200">fcntl_unlock(lock_file);</span>
                                                                                  
                                                                                  
                   <!--l. 676--><p class="noindent" ><span 
class="ectt-1200">pthread_mutex_unlock;</span></dd></dl>
               </dd></dl>
           </dd></dl>
      <!--l. 680--><p class="noindent" >mutex_lock is for multi-thread and fcntl_lock is for multi-process. fcntl_lock is the
      POSIX advisory record locking. See man 3 fcntl for details. The lock is
      system-wide, and when a process dies unexpectedly, the operating system releases
      all locks owned by the process. That&#8217;s why I chose fcntl lock for rotating
      log safely. The process needs read-write permisson for lock_file to lock
      it.
      <!--l. 687--><p class="noindent" >By default, rotate lock file = self. This way, zlog does not create any lock file
      and sets the configuration file as the lock file. As fcntl is advisory, it does
      not really forbid programmers to change and store the configuration file.
      Generally speaking, one log file will not be rotated by processes run by
      different operating system users, so using the configuration file as lock file is
      safe.
      <!--l. 694--><p class="noindent" >If you choose another path as lock file, for example, /tmp/zlog.lock, zlog will create
      it at zlog_init(). Make sure your program has permission to create and read-write
      the file. If processes run by different operating system users need to write and rotate
      the same log file, make sure that each program has permission to create and
      read-write the same lock file.
      </li>
      <li class="itemize">default format
      <!--l. 702--><p class="noindent" >This parameter is used by rules without format specified. The default is
      <!--l. 704--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 704--><p class="noindent" ><span 
class="ectt-1200">"%d</span><span 
class="ectt-1200">&#x00A0;%V</span><span 
class="ectt-1200">&#x00A0;[%p:%F:%L]</span><span 
class="ectt-1200">&#x00A0;%m%n"</span></dd></dl>
      <!--l. 707--><p class="noindent" >It will yield output like this:
      <!--l. 708--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 708--><p class="noindent" ><span 
class="ectt-1200">2012-02-14</span><span 
class="ectt-1200">&#x00A0;17:03:12</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;[3758:test_hello.c:39]</span><span 
class="ectt-1200">&#x00A0;hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
                                                                                  
                                                                                  
      </li>
      <li class="itemize">file perms
      <!--l. 713--><p class="noindent" >This specifies all log file permissions when they are created. Note that it is affected
      by user&#8217;s umask. The final file permission will be "file perms" &amp; ~umask. The
      default is 600, which just allows user read and write.
      </li>
      <li class="itemize">fsync period
      <!--l. 719--><p class="noindent" >After a number of log times per rule (to file only), zlog will call fsync(3) after write()
      to tell the Operating System to write data to disk immediately from any internal
      system buffers. The number is incremented by each rule and will be reset to 0 after
      zlog_reload(). Note that when the file&#8217;s path is generated dynamically
      or is rotated, zlog does not guarantee fsync() touch all files. It just does
      fsync() against the file descriptors that have have seen write() prior to
      the boundary time. It offers a balance between speed and data safety. An
      example:
      <!--l. 728--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 728--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;10</span><span 
class="ectt-1200">&#x00A0;100000</span>
           <!--l. 731--><p class="noindent" ><span 
class="ectt-1200">real</span>
           <span 
class="ectt-1200">0m1.806s</span>
           <!--l. 733--><p class="noindent" ><span 
class="ectt-1200">user</span>
           <span 
class="ectt-1200">0m3.060s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 735--><p class="noindent" ><span 
class="ectt-1200">sys</span>
           <span 
class="ectt-1200">&#x00A0;0m0.270s</span>
           <!--l. 737--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 739--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;wc</span><span 
class="ectt-1200">&#x00A0;-l</span><span 
class="ectt-1200">&#x00A0;press.log</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 741--><p class="noindent" ><span 
class="ectt-1200">1000000</span><span 
class="ectt-1200">&#x00A0;press.log</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 743--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 745--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;10</span><span 
class="ectt-1200">&#x00A0;100000</span><span 
class="ectt-1200">&#x00A0;#fsync</span><span 
class="ectt-1200">&#x00A0;period</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;1K</span>
           <!--l. 747--><p class="noindent" ><span 
class="ectt-1200">real</span>
           <span 
class="ectt-1200">0m41.995s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 749--><p class="noindent" ><span 
class="ectt-1200">user</span>
           <span 
class="ectt-1200">0m7.920s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 751--><p class="noindent" ><span 
class="ectt-1200">sys</span>
                                                                                  
                                                                                  
           <span 
class="ectt-1200">&#x00A0;0m0.990s</span>
           <!--l. 753--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 755--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;10</span><span 
class="ectt-1200">&#x00A0;100000</span><span 
class="ectt-1200">&#x00A0;#fsync</span><span 
class="ectt-1200">&#x00A0;period</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;10K</span>
           <!--l. 757--><p class="noindent" ><span 
class="ectt-1200">real</span>
           <span 
class="ectt-1200">0m6.856s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 759--><p class="noindent" ><span 
class="ectt-1200">user</span>
           <span 
class="ectt-1200">0m4.360s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 761--><p class="noindent" ><span 
class="ectt-1200">sys</span>
           <span 
class="ectt-1200">&#x00A0;0m0.550s</span></dd></dl>
      <!--l. 763--><p class="noindent" >If you want extreme safety but do not care about speed, use synchronous file I/O,
      see <a 
href="#x1-260005.5.3">5.5.3<!--tex4ht:ref: ite:synchronous-I/O-file --></a>.The defualt is 0, which means let the operating system flush the output
      buffer when it wants.</li></ul>
<!--l. 768--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-170005.2"></a>Levels</h3>
<!--l. 770--><p class="noindent" >This section begins with [levels] and allows the user to define application levels. You
should match these values with user-defined macros in the source file. This section can be
omitted.
<!--l. 774--><p class="indent" >   The syntax is
<!--l. 775--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 775--><p class="noindent" ><span 
class="ectt-1200">(level</span><span 
class="ectt-1200">&#x00A0;string)</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;(level</span><span 
class="ectt-1200">&#x00A0;int),</span><span 
class="ectt-1200">&#x00A0;(syslog</span><span 
class="ectt-1200">&#x00A0;level,</span><span 
class="ectt-1200">&#x00A0;optional)</span></dd></dl>
<!--l. 778--><p class="noindent" >level int should in [1,253], higher numbers mean more important. syslog level is optional, if
not set, use LOG_DEBUG
<!--l. 781--><p class="indent" >   see <a 
href="#x1-400007.3">7.3<!--tex4ht:ref: sec:User-defined-Level --></a> for more details.
<!--l. 783--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-180005.3"></a>Formats</h3>
<!--l. 785--><p class="noindent" >This section begins with [formats], where the user can define preferred log patterns. The
syntax is
<!--l. 787--><p class="noindent" >
                                                                                  
                                                                                  
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 787--><p class="noindent" ><span 
class="ectt-1200">(name)</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"(actual</span><span 
class="ectt-1200">&#x00A0;formats)"</span></dd></dl>
<!--l. 790--><p class="noindent" >It is easy to understand, (name) will be used in the next section [rules]. The format (name)
consists of letters and digits plus underscore "_". The (actual format) should be
put in double quotes. It can be built up with conversion patterns, as described
below.
<!--l. 796--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-190005.4"></a>Conversion pattern</h3>
<!--l. 798--><p class="noindent" >The conversion pattern is closely related to the conversion pattern of the C printf function.
A conversion pattern is composed of literal text and format control expressions called
conversion specifiers.
<!--l. 802--><p class="indent" >   Conversion pattern is used in both filepath of rule and pattern of format.
<!--l. 805--><p class="indent" >   You are free to insert any literal text within the conversion pattern.
<!--l. 807--><p class="indent" >   Each conversion specifier starts with a percent sign (%) and is followed by optional
format modifiers and a conversion character. The conversion character specifies the type of
data, e.g. category, level, date, thread id. The format modifiers control such things
as field width, padding, left and right justification. The following is a simple
example.
<!--l. 813--><p class="indent" >   Let the conversion pattern be
<!--l. 814--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 814--><p class="noindent" ><span 
class="ectt-1200">"%d(%m-%d</span><span 
class="ectt-1200">&#x00A0;%T)</span><span 
class="ectt-1200">&#x00A0;%-5V</span><span 
class="ectt-1200">&#x00A0;[%p:%F:%L]</span><span 
class="ectt-1200">&#x00A0;%m%n".</span></dd></dl>
<!--l. 817--><p class="noindent" >Then the statement
<!--l. 818--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 818--><p class="noindent" ><span 
class="ectt-1200">zlog_info(c,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 821--><p class="noindent" >would yield the output
<!--l. 822--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 822--><p class="noindent" ><span 
class="ectt-1200">02-14</span><span 
class="ectt-1200">&#x00A0;17:17:42</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;[4935:test_hello.c:39]</span><span 
class="ectt-1200">&#x00A0;hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
<!--l. 825--><p class="noindent" >Note that there is no explicit separator between text and conversion specifiers. The
pattern parser knows when it has reached the end of a conversion specifier when it
reads a conversion character. In the example above the conversion specifier %-5p
means the level of the logging event should be left justified to a width of five
characters.
<!--l. 831--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.4.1   </span> <a 
 id="x1-200005.4.1"></a>Conversion Characters</h4>
<!--l. 833--><p class="noindent" >The recognized conversion characters are
<a 
 id="x1-20001r1"></a>   <!--l. 837--><div class="longtable"> <table id="TBL-2" class="longtable" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-2-1g"><col 
id="TBL-2-1"></colgroup><colgroup id="TBL-2-2g"><col 
id="TBL-2-2"></colgroup><colgroup id="TBL-2-3g"><col 
id="TBL-2-3"></colgroup>
                                                                                  
                                                                                  
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-1"  
class="td11">
 <!--l. 837--><p class="noindent" >conversion
  char       </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-2"  
class="td11">
 <!--l. 838--><p class="noindent" >effect                                                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-1-3"  
class="td11">
 <!--l. 839--><p class="noindent" >example                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-1"  
class="td11">
 <!--l. 842--><p class="noindent" >%c         </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-2"  
class="td11">
 <!--l. 843--><p class="noindent" >Used
  to
  output
  the
  category
  of
  the
  logging
  event.                                                 </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-2-3"  
class="td11">
 <!--l. 844--><p class="noindent" >aa_bb                                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-1"  
class="td11">
 <!--l. 846--><p class="noindent" >%d()      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-2"  
class="td11">
 <!--l. 847--><p class="noindent" >Used
  to
  output
  the
  date
  of
  the
  logging
  event.
  The
  date
  conversion
  specifier
  may
  be
  followed
  by
  a
  date
  format
  specifier
  enclosed
  between
  parentheses.
  For
  example,
  %d(%F)
  or
  %d(%m-%d
  %T).
  If
  no
  date
  format
  specifier
  is
  given
  then
  %d(%F
  %T)
  format
  is
  assumed.
  The
  date
  format
  specifier
  permits
  the
  same
  syntax
  as
  the
  strftime(2).
  see
  <a 
href="#x1-220005.4.3">5.4.3<!--tex4ht:ref: subsec:Time-Character --></a>for
  more
  detail.                                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-3-3"  
class="td11">
 <!--l. 853--><p class="noindent" >%d(%F)
  2011-12-01
  <!--l. 855--><p class="noindent" >%d(%m-%d
  %T)
  12-01
  17:17:42
  <!--l. 857--><p class="noindent" >%d(%T.ms)
  17:17:42.035
  <!--l. 859--><p class="noindent" >%d
  2012-02-14
  17:03:12
  <!--l. 861--><p class="noindent" >%d()
  2012-02-14
  17:03:12                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-1"  
class="td11">
 <!--l. 863--><p class="noindent" >%E()      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-2"  
class="td11">
 <!--l. 864--><p class="noindent" >Value
  of
  environment
  variables                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-4-3"  
class="td11">
 <!--l. 865--><p class="noindent" >%E(LOGNAME)
  simpson                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-1"  
class="td11">
 <!--l. 867--><p class="noindent" >%ms      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-2"  
class="td11">
 <!--l. 868--><p class="noindent" >The
  millisecond,
  3-digit
  integer
  string
  <!--l. 870--><p class="noindent" >comes
  from
  gettimeofday(2)                                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-5-3"  
class="td11">
 <!--l. 871--><p class="noindent" >013                                         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-1"  
class="td11">
 <!--l. 873--><p class="noindent" >%us       </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-2"  
class="td11">
 <!--l. 874--><p class="noindent" >The
  microsecond,
  6-digit
  integer
  string
  <!--l. 876--><p class="noindent" >comes
  from
  gettimeofday(2)                                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-6-3"  
class="td11">
 <!--l. 877--><p class="noindent" >002323                                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-1"  
class="td11">
 <!--l. 879--><p class="noindent" >%F        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-2"  
class="td11">
 <!--l. 880--><p class="noindent" >Used
  to
  output
  the
  file
  name
  where
  the
  logging
  request
  was
  issued.
  The
  file
  name
  comes
  from
  __FILE__
  macro.
  Some
  compilers
  supply
  __FILE__
  as
  the
  absolute
  path.
  Use
  %f
  to
  strip
  path
  and
  keep
  the
  file
  name.
  Some
  compilers
  have
  an
  option
  to
  control
  this
  feature.                                               </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-7-3"  
class="td11">
 <!--l. 884--><p class="noindent" >test_hello.c
  <!--l. 886--><p class="noindent" >or,
  under
  some
  compiler
  <!--l. 888--><p class="noindent" >/home/zlog/src/test/test_hello.c  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-1"  
class="td11">
 <!--l. 890--><p class="noindent" >%f         </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-2"  
class="td11">
 <!--l. 891--><p class="noindent" >Used
  to
  output
  the
  source
  file
  name,
  the
  string
  after
  the
  last
  &#8217;/&#8217;
  of
  $F.
  It
  will
  cause
  a
  little
  performance
  loss
  in
  each
  log
  event.                                                 </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-8-3"  
class="td11">
 <!--l. 893--><p class="noindent" >test_hello.c                              </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-1"  
class="td11">
 <!--l. 895--><p class="noindent" >%H        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-2"  
class="td11">
 <!--l. 896--><p class="noindent" >Used
  to
  output
  the
  hostname
  of
  system,
  which
  is
  from
  gethostname(2)                                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-9-3"  
class="td11">
 <!--l. 897--><p class="noindent" >zlog-dev                                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-1"  
class="td11">
 <!--l. 899--><p class="noindent" >%L        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-2"  
class="td11">
 <!--l. 900--><p class="noindent" >Used
  to
  output
  the
  line
  number
  from
  where
  the
  logging
  request
  was
  issued,
  which
  comes
  from
  __LINE__
  macro                                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-10-3"  
class="td11">
 <!--l. 902--><p class="noindent" >135                                         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-1"  
class="td11">
 <!--l. 904--><p class="noindent" >%m        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-2"  
class="td11">
 <!--l. 905--><p class="noindent" >Used
  to
  output
  the
  application
  supplied
  message
  associated
  with
  the
  logging
  event.                                                 </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-11-3"  
class="td11">
 <!--l. 907--><p class="noindent" >hello,
  zlog                                        </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-1"  
class="td11">
 <!--l. 909--><p class="noindent" >%M       </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-2"  
class="td11">
 <!--l. 910--><p class="noindent" >Used
  to
  output
  the
  MDC
  (mapped
  diagnostic
  context)
  associated
  with
  the
  thread
  that
  generated
  the
  logging
  event.
  The
  M
  conversion
  character
  must
  be
  followed
  by
  the
  key
  for
  the
  map
  placed
  between
  parenthesis,
  as
  in
  %M(clientNumber)
  where
  clientNumber
  is
  the
  key.
  The
  value
  in
  the
  MDC
  corresponding
  to
  the
  key
  will
  be
  output.See
  <a 
href="#x1-380007.1">7.1<!--tex4ht:ref: sec:MDC --></a>
  for
  more
  detail.                                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-12-3"  
class="td11">
 <!--l. 916--><p class="noindent" >%M(clientNumber)
  12345                                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-1"  
class="td11">
 <!--l. 918--><p class="noindent" >%n        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-2"  
class="td11">
 <!--l. 919--><p class="noindent" >Outputs
  unix
  newline
  character,
  zLog
  does
  not
  support
  the
  MS-Windows
  line
  separator
  at
  this
  time.                                                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-13-3"  
class="td11">
 <!--l. 921--><p class="noindent" >\n                                          </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-14-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-14-1"  
class="td11">
 <!--l. 923--><p class="noindent" >%p        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-14-2"  
class="td11">
 <!--l. 924--><p class="noindent" >Used
  to
  output
  the
  id
  of
  the
  process
  that
  generated
  the
  logging
  event,
  which
  comes
  from
  getpid().                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-14-3"  
class="td11">
 <!--l. 926--><p class="noindent" >2134                                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-15-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-15-1"  
class="td11">
 <!--l. 928--><p class="noindent" >%U        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-15-2"  
class="td11">
 <!--l. 929--><p class="noindent" >Used
  to
  output
  the
  function
  name
  where
  the
  logging
  request
  was
  issued.
  It
  comes
  from
  __func__(C99)
  or
  __FUNCTION__(gcc)
  macro,
  with
  the
  support
  of
  the
  compiler.                                            </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-15-3"  
class="td11">
 <!--l. 932--><p class="noindent" >main                                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-16-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-16-1"  
class="td11">
 <!--l. 934--><p class="noindent" >%V        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-16-2"  
class="td11">
 <!--l. 935--><p class="noindent" >Used
  to
  output
  the
  level
  of
  the
  logging
  event,
  uppercase.                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-16-3"  
class="td11">
 <!--l. 936--><p class="noindent" >INFO                                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-17-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-17-1"  
class="td11">
 <!--l. 938--><p class="noindent" >%v        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-17-2"  
class="td11">
 <!--l. 939--><p class="noindent" >Used
  to
  output
  the
  level
  of
  the
  logging
  event,
  lowercase.                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-17-3"  
class="td11">
 <!--l. 940--><p class="noindent" >info                                         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-18-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-18-1"  
class="td11">
 <!--l. 942--><p class="noindent" >%t         </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-18-2"  
class="td11">
 <!--l. 943--><p class="noindent" >Used
  to
  output
  the
  hexadecimal
  form
  of
  the
  thread
  id
  that
  generated
  the
  logging
  event,
  which
  comes
  from
  pthread_self().
  <!--l. 946--><p class="noindent" >"0x%x",(unsigned
  int)
  pthread_t                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-18-3"  
class="td11">
 <!--l. 947--><p class="noindent" >0xba01e700                              </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-19-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-19-1"  
class="td11">
 <!--l. 949--><p class="noindent" >%T        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-19-2"  
class="td11">
 <!--l. 950--><p class="noindent" >Equivalent
  to
  %t,
  but
  the
  long
  form
  <!--l. 952--><p class="noindent" >"%lu",
  (unsigned
  long)
  pthread_t                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-19-3"  
class="td11">
 <!--l. 953--><p class="noindent" >140633234859776                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-20-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-20-1"  
class="td11">
 <!--l. 955--><p class="noindent" >%%        </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-20-2"  
class="td11">
 <!--l. 956--><p class="noindent" >the
  sequence
  %%
  outputs
  a
  single
  percent
  sign.                                                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-20-3"  
class="td11">
 <!--l. 957--><p class="noindent" >%                                           </td>
                                                                                  
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-21-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-21-1"  
class="td11">          </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-21-2"  
class="td11">                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-21-3"  
class="td11"></td></tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-22-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-22-1"  
class="td11">
 <!--l. 959--><p class="noindent" >%[other
  char]      </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-22-2"  
class="td11">
 <!--l. 960--><p class="noindent" >parsed
  as
  a
  wrong
  syntax,
  will
  cause
  zlog_init()
  fail                                                    </td><td  style="white-space:wrap; text-align:left;" id="TBL-2-22-3"  
class="td11">
 <!--l. 962--><p class="noindent" >                             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-2-23-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-23-1"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-24-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-24-1"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-25-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-25-1"  
class="td11">
 <!--l. 963--><p class="noindent" >        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-26-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-26-1"  
class="td11">
 <!--l. 963--><p class="noindent" >        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-2-27-"><td  style="white-space:wrap; text-align:left;" id="TBL-2-27-1"  
class="td11">
 <!--l. 963--><p class="noindent" >        </td>
   </tr>
   </table></div>
<!--l. 965--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.4.2   </span> <a 
 id="x1-210005.4.2"></a>Format Modifier </h4>
<!--l. 967--><p class="noindent" >By default, the relevant information is output as-is. However, with the aid of
format modifiers it is possible to change the minimum field width, the maximum
field width, and justification. It will cause a little performance loss in each log
event.
<!--l. 972--><p class="indent" >   The optional format modifier is placed between the percent sign and the conversion
character.
<!--l. 975--><p class="indent" >   The first optional format modifier is the left justification flag which is just the
minus (-) character. Then comes the optional minimum field width modifier.
This is a decimal constant that represents the minimum number of characters to
output. If the data item requires fewer characters, it is padded on either the left or
the right until the minimum width is reached. The default is to pad on the left
(right justify) but you can specify right padding with the left justification flag.
The padding character is space. If the data item is larger than the minimum
                                                                                  
                                                                                  
field width, the field is expanded to accommodate the data. The value is never
truncated.
<!--l. 986--><p class="indent" >   This behavior can be changed using the maximum field width modifier which is
designated by a period followed by a decimal constant. If the data item is longer than the
maximum field, then the extra characters are removed from the beginning of the data item
and not from the end. For example, if the maximum field width is eight and the data item
is ten characters long, then the last two characters of the data item are dropped.
This behavior equals the printf function in C where truncation is done from the
end.
<!--l. 995--><p class="indent" >   Below are various format modifier examples for the category conversion specifier.
   <div class="tabular"> <table id="TBL-3" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-3-1g"><col 
id="TBL-3-1"></colgroup><colgroup id="TBL-3-2g"><col 
id="TBL-3-2"></colgroup><colgroup id="TBL-3-3g"><col 
id="TBL-3-3"></colgroup><colgroup id="TBL-3-4g"><col 
id="TBL-3-4"></colgroup><colgroup id="TBL-3-5g"><col 
id="TBL-3-5"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-1-1"  
class="td11"> <!--l. 1000--><p class="noindent" >format
  modifier </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-1-2"  
class="td11"> <!--l. 1001--><p class="noindent" >left
  justify  </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-1-3"  
class="td11"> <!--l. 1002--><p class="noindent" >minimum
  width   </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-1-4"  
class="td11"> <!--l. 1003--><p class="noindent" >maximum
  width   </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-1-5"  
class="td11"> <!--l. 1004--><p class="noindent" >comment                                                        </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-1"  
class="td11"> <!--l. 1007--><p class="noindent" >%20c      </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-2"  
class="td11"> <!--l. 1008--><p class="noindent" >false     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-3"  
class="td11"> <!--l. 1009--><p class="noindent" >20       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-4"  
class="td11"> <!--l. 1010--><p class="noindent" >none    </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-2-5"  
class="td11"> <!--l. 1011--><p class="noindent" >Left pad with spaces if the category name is less
  than 20 characters long.                                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-1"  
class="td11"> <!--l. 1015--><p class="noindent" >%-20c     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-2"  
class="td11"> <!--l. 1016--><p class="noindent" >true     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-3"  
class="td11"> <!--l. 1017--><p class="noindent" >20       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-4"  
class="td11"> <!--l. 1018--><p class="noindent" >none    </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-3-5"  
class="td11"> <!--l. 1019--><p class="noindent" >Right pad with spaces if the category name is less
  than 20 characters long.                                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-1"  
class="td11"> <!--l. 1023--><p class="noindent" >%.30c     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-2"  
class="td11"> <!--l. 1024--><p class="noindent" >NA      </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-3"  
class="td11"> <!--l. 1025--><p class="noindent" >none    </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-4"  
class="td11"> <!--l. 1026--><p class="noindent" >30       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-4-5"  
class="td11"> <!--l. 1027--><p class="noindent" >Truncate from the end if the category name is
  longer than 30 characters.                                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-5-1"  
class="td11"> <!--l. 1030--><p class="noindent" >%20.30c  </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-5-2"  
class="td11"> <!--l. 1031--><p class="noindent" >false     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-5-3"  
class="td11"> <!--l. 1032--><p class="noindent" >20       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-5-4"  
class="td11"> <!--l. 1033--><p class="noindent" >30       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-5-5"  
class="td11"> <!--l. 1034--><p class="noindent" >Left pad with spaces if the category name is
  shorter than 20 characters. However, if category
  name is longer than 30 characters, then truncate
  from the end.                                                  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-6-1"  
class="td11"> <!--l. 1039--><p class="noindent" >%-20.30c </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-6-2"  
class="td11"> <!--l. 1040--><p class="noindent" >true     </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-6-3"  
class="td11"> <!--l. 1041--><p class="noindent" >20       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-6-4"  
class="td11"> <!--l. 1042--><p class="noindent" >30       </td><td  style="white-space:wrap; text-align:left;" id="TBL-3-6-5"  
class="td11"> <!--l. 1043--><p class="noindent" >Right pad with spaces if the category name is
  shorter than 20 characters. However, if category
  name is longer than 30 characters, then truncate
  from the end.                                                  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-3-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-3-7-1"  
class="td11">         </td> </tr></table></div>
<!--l. 1049--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.4.3   </span> <a 
 id="x1-220005.4.3"></a>Time Character</h4>
<!--l. 1051--><p class="noindent" >Here is the Time Character support by Conversion Character <span 
class="ecti-1200">d.</span>
<!--l. 1053--><p class="indent" >   All Character is supported by strftime(3) in library. The Character supported on my
linux system are
<a 
 id="x1-22001r2"></a>   <!--l. 1058--><div class="longtable"> <table id="TBL-4" class="longtable" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-4-1g"><col 
id="TBL-4-1"></colgroup><colgroup id="TBL-4-2g"><col 
id="TBL-4-2"></colgroup><colgroup id="TBL-4-3g"><col 
id="TBL-4-3"></colgroup>
                                                                                  
                                                                                  
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-1-1"  
class="td11">
 <!--l. 1058--><p class="noindent" >character</td><td  style="white-space:wrap; text-align:left;" id="TBL-4-1-2"  
class="td11">
 <!--l. 1059--><p class="noindent" >effect                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-1-3"  
class="td11">
 <!--l. 1060--><p class="noindent" >example             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-2-1"  
class="td11">
 <!--l. 1063--><p class="noindent" >%a         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-2-2"  
class="td11">
 <!--l. 1064--><p class="noindent" >The
  abbreviated
  weekday
  name
  according
  to
  the
  current
  locale.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-2-3"  
class="td11">
 <!--l. 1065--><p class="noindent" >Wed                  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-3-1"  
class="td11">
 <!--l. 1067--><p class="noindent" >%A        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-3-2"  
class="td11">
 <!--l. 1068--><p class="noindent" >The
  full
  weekday
  name
  according
  to
  the
  current
  locale.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-3-3"  
class="td11">
 <!--l. 1069--><p class="noindent" >Wednesday         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-4-1"  
class="td11">
 <!--l. 1071--><p class="noindent" >%b        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-4-2"  
class="td11">
 <!--l. 1072--><p class="noindent" >The
  abbreviated
  month
  name
  according
  to
  the
  current
  locale.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-4-3"  
class="td11">
 <!--l. 1073--><p class="noindent" >Mar                  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-5-1"  
class="td11">
 <!--l. 1075--><p class="noindent" >%B        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-5-2"  
class="td11">
 <!--l. 1076--><p class="noindent" >The
  full
  month
  name
  according
  to
  the
  current
  locale.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-5-3"  
class="td11">
 <!--l. 1077--><p class="noindent" >March               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-6-1"  
class="td11">
 <!--l. 1079--><p class="noindent" >%c         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-6-2"  
class="td11">
 <!--l. 1080--><p class="noindent" >The
  preferred
  date
  and
  time
  representation
  for
  the
  current
  locale.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-6-3"  
class="td11">
 <!--l. 1081--><p class="noindent" >Thu
  Feb
  16
  14:16:35
  2012                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-7-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-7-1"  
class="td11">
 <!--l. 1083--><p class="noindent" >%C        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-7-2"  
class="td11">
 <!--l. 1084--><p class="noindent" >The
  century
  number
  (year/100)
  as
  a
  2-digit
  integer.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-7-3"  
class="td11">
 <!--l. 1085--><p class="noindent" >20                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-8-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-8-1"  
class="td11">
 <!--l. 1087--><p class="noindent" >%d        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-8-2"  
class="td11">
 <!--l. 1088--><p class="noindent" >The
  day
  of
  the
  month
  as
  a
  decimal
  number
  (range
  01
  to
  31).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-8-3"  
class="td11">
 <!--l. 1089--><p class="noindent" >06                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-9-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-9-1"  
class="td11">
 <!--l. 1091--><p class="noindent" >%D        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-9-2"  
class="td11">
 <!--l. 1092--><p class="noindent" >Equivalent
  to
  %m/%d/%y.
  (for
  Americans
  only.
  Americans
  should
  note
  that
  in
  other
  countries
  %d/%m/%y
  is
  more
  common.
  This
  means
  that
  in
  an
  international
  context
  this
  format
  is
  ambiguous
  and
  should
  not
  be
  used.)
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-9-3"  
class="td11">
 <!--l. 1096--><p class="noindent" >02/16/12           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-10-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-10-1"  
class="td11">
 <!--l. 1098--><p class="noindent" >%e         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-10-2"  
class="td11">
 <!--l. 1099--><p class="noindent" >Like
  %d,
  the
  day
  of
  the
  month
  as
  a
  decimal
  number,
  but
  a
  leading
  zero
  is
  replaced
  by
  a
  space.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-10-3"  
class="td11">
 <!--l. 1101--><p class="noindent" >6                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-11-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-11-1"  
class="td11">
 <!--l. 1103--><p class="noindent" >%F        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-11-2"  
class="td11">
 <!--l. 1104--><p class="noindent" >Equivalent
  to
  %Y-%m-%d
  (the
  ISO
  8601
  date
  format).
  (C99)                                                            </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-11-3"  
class="td11">
 <!--l. 1105--><p class="noindent" >2012-02-16         </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-12-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-12-1"  
class="td11">
 <!--l. 1107--><p class="noindent" >%G        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-12-2"  
class="td11">
 <!--l. 1108--><p class="noindent" >The
  ISO
  8601
  week-based
  year
  (see
  NOTES)
  with
  century
  as
  a
  decimal
  number.
  The
  4-digit
  year
  corresponding
  to
  the
  ISO
  week
  number
  (see
  %V).
  This
  has
  the
  same
  format
  and
  value
  as
  %Y,
  except
  that
  if
  the
  ISO
  week
  number
  belongs
  to
  the
  previous
  or
  next
  year,
  that
  year
  is
  used
  instead.
  (TZ)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-12-3"  
class="td11">
 <!--l. 1113--><p class="noindent" >2012                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-13-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-13-1"  
class="td11">
 <!--l. 1115--><p class="noindent" >%g         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-13-2"  
class="td11">
 <!--l. 1116--><p class="noindent" >Like
  %G,
  but
  without
  century,
  that
  is,
  with
  a
  2-digit
  year
  (00-99).
  (TZ)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-13-3"  
class="td11">
 <!--l. 1118--><p class="noindent" >12                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-14-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-14-1"  
class="td11">
 <!--l. 1120--><p class="noindent" >%h        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-14-2"  
class="td11">
 <!--l. 1121--><p class="noindent" >Equivalent
  to
  %b.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-14-3"  
class="td11">
 <!--l. 1122--><p class="noindent" >Feb                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-15-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-15-1"  
class="td11">
 <!--l. 1124--><p class="noindent" >%H        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-15-2"  
class="td11">
 <!--l. 1125--><p class="noindent" >The
  hour
  as
  a
  decimal
  number
  using
  a
  24-hour
  clock
  (range
  00
  to
  23).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-15-3"  
class="td11">
 <!--l. 1126--><p class="noindent" >14                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-16-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-16-1"  
class="td11">
 <!--l. 1128--><p class="noindent" >%I         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-16-2"  
class="td11">
 <!--l. 1129--><p class="noindent" >The
  hour
  as
  a
  decimal
  number
  using
  a
  12-hour
  clock
  (range
  01
  to
  12).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-16-3"  
class="td11">
 <!--l. 1130--><p class="noindent" >02                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-17-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-17-1"  
class="td11">
 <!--l. 1132--><p class="noindent" >%j         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-17-2"  
class="td11">
 <!--l. 1133--><p class="noindent" >The
  day
  of
  the
  year
  as
  a
  decimal
  number
  (range
  001
  to
  366).                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-17-3"  
class="td11">
 <!--l. 1134--><p class="noindent" >047                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-18-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-18-1"  
class="td11">
 <!--l. 1136--><p class="noindent" >%k        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-18-2"  
class="td11">
 <!--l. 1137--><p class="noindent" >The
  hour
  (24-hour
  clock)
  as
  a
  decimal
  number
  (range
  0
  to
  23);
  single
  digits
  are
  preceded
  by
  a
  blank.
  (See
  also
  %H.)
  (TZ)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-18-3"  
class="td11">
 <!--l. 1139--><p class="noindent" >15                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-19-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-19-1"  
class="td11">
 <!--l. 1141--><p class="noindent" >%l         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-19-2"  
class="td11">
 <!--l. 1142--><p class="noindent" >The
  hour
  (12-hour
  clock)
  as
  a
  decimal
  number
  (range
  1
  to
  12);
  single
  digits
  are
  preceded
  by
  a
  blank.
  (See
  also
  %I.)
  (TZ)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-19-3"  
class="td11">
 <!--l. 1144--><p class="noindent" >3                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-20-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-20-1"  
class="td11">
 <!--l. 1146--><p class="noindent" >%m        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-20-2"  
class="td11">
 <!--l. 1147--><p class="noindent" >The
  month
  as
  a
  decimal
  number
  (range
  01
  to
  12).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-20-3"  
class="td11">
 <!--l. 1148--><p class="noindent" >02                    </td>
                                                                                  
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-21-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-21-1"  
class="td11">          </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-21-2"  
class="td11">                                                   </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-21-3"  
class="td11">
                                                                                  
                                                                                  
   </td></tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-22-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-22-1"  
class="td11">
 <!--l. 1150--><p class="noindent" >%M       </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-22-2"  
class="td11">
 <!--l. 1151--><p class="noindent" >The
  minute
  as
  a
  decimal
  number
  (range
  00
  to
  59).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-22-3"  
class="td11">
 <!--l. 1152--><p class="noindent" >11                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-23-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-23-1"  
class="td11">
 <!--l. 1154--><p class="noindent" >%n        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-23-2"  
class="td11">
 <!--l. 1155--><p class="noindent" >A
  newline
  character.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-23-3"  
class="td11">
 <!--l. 1156--><p class="noindent" >\n                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-24-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-24-1"  
class="td11">
 <!--l. 1158--><p class="noindent" >%p        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-24-2"  
class="td11">
 <!--l. 1159--><p class="noindent" >Either
  "AM"
  or
  "PM"
  according
  to
  the
  given
  time
  value,
  or
  the
  corresponding
  strings
  for
  the
  current
  locale.
  Noon
  is
  treated
  as
  "PM"
  and
  midnight
  as
  "AM".                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-24-3"  
class="td11">
 <!--l. 1163--><p class="noindent" >PM                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-25-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-25-1"  
class="td11">
 <!--l. 1165--><p class="noindent" >%P        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-25-2"  
class="td11">
 <!--l. 1166--><p class="noindent" >Like
  %p
  but
  in
  lowercase:
  "am"
  or
  "pm"
  or
  a
  corresponding
  string
  for
  the
  current
  locale.
  (GNU)                                                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-25-3"  
class="td11">
 <!--l. 1168--><p class="noindent" >pm                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-26-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-26-1"  
class="td11">
 <!--l. 1170--><p class="noindent" >%r         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-26-2"  
class="td11">
 <!--l. 1171--><p class="noindent" >The
  time
  in
  a.m.
  or
  p.m.
  notation.
  In
  the
  POSIX
  locale
  this
  is
  equivalent
  to
  %I:%M:%S
  %p.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-26-3"  
class="td11">
 <!--l. 1173--><p class="noindent" >03:11:54
  PM                   </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-27-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-27-1"  
class="td11">
 <!--l. 1175--><p class="noindent" >%R        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-27-2"  
class="td11">
 <!--l. 1176--><p class="noindent" >The
  time
  in
  24-hour
  notation
  (%H:%M).
  (SU)
  For
  a
  version
  including
  the
  seconds,
  see
  %T
  below.                                                           </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-27-3"  
class="td11">
 <!--l. 1178--><p class="noindent" >15:11                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-28-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-28-1"  
class="td11">
 <!--l. 1180--><p class="noindent" >%s         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-28-2"  
class="td11">
 <!--l. 1181--><p class="noindent" >The
  number
  of
  seconds
  since
  the
  Epoch,
  that
  is,
  since
  1970-01-01
  00:00:00
  UTC.
  (TZ)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-28-3"  
class="td11">
 <!--l. 1183--><p class="noindent" >1329376487        </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-29-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-29-1"  
class="td11">
 <!--l. 1185--><p class="noindent" >%S        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-29-2"  
class="td11">
 <!--l. 1186--><p class="noindent" >The
  second
  as
  a
  decimal
  number
  (range
  00
  to
  60).
  (The
  range
  is
  up
  to
  60
  to
  allow
  for
  occasional
  leap
  seconds.)                                                        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-29-3"  
class="td11">
 <!--l. 1188--><p class="noindent" >54                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-30-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-30-1"  
class="td11">
 <!--l. 1190--><p class="noindent" >%t         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-30-2"  
class="td11">
 <!--l. 1191--><p class="noindent" >A
  tab
  character.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-30-3"  
class="td11">
 <!--l. 1193--><p class="noindent" >               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-31-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-31-1"  
class="td11">
 <!--l. 1194--><p class="noindent" >%T        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-31-2"  
class="td11">
 <!--l. 1195--><p class="noindent" >The
  time
  in
  24-hour
  notation
  (%H:%M:%S).
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-31-3"  
class="td11">
 <!--l. 1196--><p class="noindent" >15:14:47             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-32-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-32-1"  
class="td11">
 <!--l. 1198--><p class="noindent" >%u        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-32-2"  
class="td11">
 <!--l. 1199--><p class="noindent" >The
  day
  of
  the
  week
  as
  a
  decimal,
  range
  1
  to
  7,
  Monday
  being
  1.
  See
  also
  %w.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-32-3"  
class="td11">
 <!--l. 1201--><p class="noindent" >4                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-33-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-33-1"  
class="td11">
 <!--l. 1203--><p class="noindent" >%U        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-33-2"  
class="td11">
 <!--l. 1204--><p class="noindent" >The
  week
  number
  of
  the
  current
  year
  as
  a
  decimal
  number,
  range
  00
  to
  53,
  starting
  with
  the
  first
  Sun-
  day
  as
  the
  first
  day
  of
  week
  01.
  See
  also
  %V
  and
  %W.                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-33-3"  
class="td11">
 <!--l. 1207--><p class="noindent" >07                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-34-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-34-1"  
class="td11">
 <!--l. 1209--><p class="noindent" >%V        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-34-2"  
class="td11">
 <!--l. 1210--><p class="noindent" >The
  ISO
  8601
  week
  number
  (see
  NOTES)
  of
  the
  current
  year
  as
  a
  decimal
  number,
  range
  01
  to
  53,
  where
  week
  1
  is
  the
  first
  week
  that
  has
  at
  least
  4
  days
  in
  the
  new
  year.
  See
  also
  %U
  and
  %W.
  (SU)                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-34-3"  
class="td11">
 <!--l. 1213--><p class="noindent" >07                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-35-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-35-1"  
class="td11">
 <!--l. 1215--><p class="noindent" >%w        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-35-2"  
class="td11">
 <!--l. 1216--><p class="noindent" >The
  day
  of
  the
  week
  as
  a
  decimal,
  range
  0
  to
  6,
  Sunday
  being
  0.
  See
  also
  %u.                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-35-3"  
class="td11">
 <!--l. 1218--><p class="noindent" >4                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-36-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-36-1"  
class="td11">
 <!--l. 1220--><p class="noindent" >%W       </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-36-2"  
class="td11">
 <!--l. 1221--><p class="noindent" >The
  week
  number
  of
  the
  current
  year
  as
  a
  decimal
  number,
  range
  00
  to
  53,
  starting
  with
  the
  first
  Mon-
  day
  as
  the
  first
  day
  of
  week
  01.                                                                </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-36-3"  
class="td11">
 <!--l. 1223--><p class="noindent" >07                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-37-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-37-1"  
class="td11">
 <!--l. 1225--><p class="noindent" >%x        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-37-2"  
class="td11">
 <!--l. 1226--><p class="noindent" >The
  preferred
  date
  representation
  for
  the
  current
  locale
  without
  the
  time.                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-37-3"  
class="td11">
 <!--l. 1228--><p class="noindent" >02/16/12           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-38-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-38-1"  
class="td11">
 <!--l. 1230--><p class="noindent" >%X        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-38-2"  
class="td11">
 <!--l. 1231--><p class="noindent" >The
  preferred
  time
  representation
  for
  the
  current
  locale
  without
  the
  date.                                                             </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-38-3"  
class="td11">
 <!--l. 1233--><p class="noindent" >15:14:47             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-39-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-39-1"  
class="td11">
 <!--l. 1235--><p class="noindent" >%y        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-39-2"  
class="td11">
 <!--l. 1236--><p class="noindent" >The
  year
  as
  a
  decimal
  number
  without
  a
  century
  (range
  00
  to
  99).                                                              </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-39-3"  
class="td11">
 <!--l. 1237--><p class="noindent" >12                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-40-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-40-1"  
class="td11">
 <!--l. 1239--><p class="noindent" >%Y        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-40-2"  
class="td11">
 <!--l. 1240--><p class="noindent" >The
  year
  as
  a
  decimal
  number
  including
  the
  century.                                                         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-40-3"  
class="td11">
 <!--l. 1241--><p class="noindent" >2012                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-41-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-41-1"  
class="td11">
 <!--l. 1243--><p class="noindent" >%z         </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-41-2"  
class="td11">
 <!--l. 1244--><p class="noindent" >The
  time-zone
  as
  hour
  offset
  from
  GMT.
  Required
  to
  emit
  RFC
  822-conformant
  dates
  (using
  "%a,
  %d
  %b
  %Y
  %H:%M:%S
  %z").
  (GNU)                                                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-41-3"  
class="td11">
 <!--l. 1247--><p class="noindent" >+0800               </td>
                                                                                  
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-42-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-42-1"  
class="td11">
 <!--l. 1248--><p class="noindent" >        </td>
   </tr>
<tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-43-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-43-1"  
class="td11">
 <!--l. 1249--><p class="noindent" >%Z        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-43-2"  
class="td11">
 <!--l. 1250--><p class="noindent" >The
  timezone
  or
  name
  or
  abbreviation.                                                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-43-3"  
class="td11">
 <!--l. 1251--><p class="noindent" >CST                 </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-44-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-44-1"  
class="td11">
 <!--l. 1253--><p class="noindent" >%%        </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-44-2"  
class="td11">
 <!--l. 1254--><p class="noindent" >A
  literal
  &#8217;%&#8217;
  character.                                                       </td><td  style="white-space:wrap; text-align:left;" id="TBL-4-44-3"  
class="td11">
 <!--l. 1255--><p class="noindent" >%                     </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-4-45-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-45-1"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-46-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-46-1"  
class="td11">         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-47-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-47-1"  
class="td11">
 <!--l. 1257--><p class="noindent" >        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-48-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-48-1"  
class="td11">
 <!--l. 1257--><p class="noindent" >        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-4-49-"><td  style="white-space:wrap; text-align:left;" id="TBL-4-49-1"  
class="td11">
 <!--l. 1257--><p class="noindent" >        </td>
   </tr>
   </table></div>
<!--l. 1260--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-230005.5"></a>Rules</h3>
<!--l. 1262--><p class="noindent" >This section begins with [rules]. It decides how log actions are filtered, formatted and
output. This section can be omitted, but there will result in no log output. The syntax
is
<!--l. 1265--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1265--><p class="noindent" ><span 
class="ectt-1200">(category).(level)</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(output),</span><span 
class="ectt-1200">&#x00A0;(option,optional);</span><span 
class="ectt-1200">&#x00A0;(format</span><span 
class="ectt-1200">&#x00A0;name,</span><span 
class="ectt-1200">&#x00A0;optional)</span></dd></dl>
<!--l. 1268--><p class="noindent" >When zlog_init() is called, all rules will be read into memory. When zlog_get_category() is
                                                                                  
                                                                                  
called, mutiple rules will be assigned to each category, in the way <a 
href="#x1-250005.5.2">5.5.2<!--tex4ht:ref: subsec:Category-Matching --></a> describes. When
logging is performed, the level between matched rules and INFO will be checked to decide
whether this single log will be output through the rule. When zlog_reload() is called, the
configuration file will be re-read into memory, including rules. All category rules will be
re-calculated.
<!--l. 1277--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.5.1   </span> <a 
 id="x1-240005.5.1"></a>Level Matching</h4>
<!--l. 1279--><p class="noindent" >There are six default levels in zlog, "DEBUG", "INFO", "NOTICE", "WARN",
"ERROR" and "FATAL". As in all other log libraries, aa.DEBUG means all logs of level
greater than or equal to DEBUG will be output. Still, there are more expressions.
Levels in the configuration file are not case sensitive; both capital or lowercase are
accepted.
   <div class="tabular"> <table id="TBL-5" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-5-1g"><col 
id="TBL-5-1"></colgroup><colgroup id="TBL-5-2g"><col 
id="TBL-5-2"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-1-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-1"  
class="td11"> example expression  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-1-2"  
class="td11">       meaning           </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-2-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-1"  
class="td11">         *              </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-2-2"  
class="td11">    all [source level]      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-3-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-1"  
class="td11">      aa.debug         </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-3-2"  
class="td11"> [source level]&#x003E;=debug  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-4-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-4-1"  
class="td11">     aa.=debug        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-4-2"  
class="td11"> [source level]==debug  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-5-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-5-1"  
class="td11">     aa.!debug        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-5-5-2"  
class="td11"> [source level]!=debug  </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-5-6-"><td  style="white-space:nowrap; text-align:center;" id="TBL-5-6-1"  
class="td11">                   </td> </tr></table></div>
<!--l. 1307--><p class="indent" >   The level strings can be defined by the user. See<a 
href="#x1-400007.3">7.3<!--tex4ht:ref: sec:User-defined-Level --></a>.
<!--l. 1309--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.5.2   </span> <a 
 id="x1-250005.5.2"></a>Category Matching</h4>
<!--l. 1311--><p class="noindent" >Category Matching is simple. The name of the category is made up of letters, digits,
and/or the underscore "_".
                                                                                  
                                                                                  
   <div class="tabular"> <table id="TBL-6" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-6-1g"><col 
id="TBL-6-1"></colgroup><colgroup id="TBL-6-2g"><col 
id="TBL-6-2"></colgroup><colgroup id="TBL-6-3g"><col 
id="TBL-6-3"></colgroup><colgroup id="TBL-6-4g"><col 
id="TBL-6-4"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-1-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-1"  
class="td11"> <!--l. 1316--><p class="noindent" >summarize         </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-2"  
class="td11"> <!--l. 1317--><p class="noindent" >category
  string
  from
  configure
  file              </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-3"  
class="td11"> <!--l. 1318--><p class="noindent" >category
  matches                  </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-1-4"  
class="td11"> <!--l. 1319--><p class="noindent" >category
  not
  matches             </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-2-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-1"  
class="td11"> <!--l. 1322--><p class="noindent" >*
  matches
  all                     </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-2"  
class="td11"> <!--l. 1323--><p class="noindent" >*.*              </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-3"  
class="td11"> <!--l. 1324--><p class="noindent" >aa,
  aa_bb,
  aa_cc,
  xx,
  yy
  ...                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-2-4"  
class="td11"> <!--l. 1325--><p class="noindent" >NONE               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-3-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-1"  
class="td11"> <!--l. 1327--><p class="noindent" >string
  end
  with
  underline
  matches
  super-category
  and
  sub-categories      </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-2"  
class="td11"> <!--l. 1328--><p class="noindent" >aa_.*          </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-3"  
class="td11"> <!--l. 1329--><p class="noindent" >aa,
  aa_bb,
  aa_cc,
  aa_bb_cc               </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-3-4"  
class="td11"> <!--l. 1330--><p class="noindent" >xx,
  yy                    </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-4-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-1"  
class="td11"> <!--l. 1332--><p class="noindent" >string
  not
  ending
  with
  underline
  accurately
  matches
  category             </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-2"  
class="td11"> <!--l. 1333--><p class="noindent" >aa.*             </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-3"  
class="td11"> <!--l. 1334--><p class="noindent" >aa                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-4-4"  
class="td11"> <!--l. 1335--><p class="noindent" >aa_bb,
  aa_cc,
  aa_bb_cc          </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-5-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-1"  
class="td11"> <!--l. 1337--><p class="noindent" >!
  matches
  category
  that
  has
  no
  rule
  matched             </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-2"  
class="td11"> <!--l. 1338--><p class="noindent" >!.*               </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-3"  
class="td11"> <!--l. 1339--><p class="noindent" >xx                          </td><td  style="white-space:wrap; text-align:left;" id="TBL-6-5-4"  
class="td11"> <!--l. 1340--><p class="noindent" >aa(as
  it
  matches
  rules
  above)               </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-6-6-"><td  style="white-space:wrap; text-align:left;" id="TBL-6-6-1"  
class="td11">                 </td> </tr></table></div>
<!--l. 1344--><p class="noindent" >
   <h4 class="subsectionHead"><span class="titlemark">5.5.3   </span> <a 
 id="x1-260005.5.3"></a>Output Action</h4>
                                                                                  
                                                                                  
<!--l. 1346--><p class="noindent" >zlog supports various output methods. The syntax is
<!--l. 1347--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1347--><p class="noindent" ><span 
class="ectt-1200">(output</span><span 
class="ectt-1200">&#x00A0;action),</span><span 
class="ectt-1200">&#x00A0;(output</span><span 
class="ectt-1200">&#x00A0;option);</span><span 
class="ectt-1200">&#x00A0;(format</span><span 
class="ectt-1200">&#x00A0;name,</span><span 
class="ectt-1200">&#x00A0;optional)</span></dd></dl>
                                                                                  
                                                                                  
<div class="tabular"> <table id="TBL-7" class="tabular" 
cellspacing="0" cellpadding="0" rules="groups" 
><colgroup id="TBL-7-1g"><col 
id="TBL-7-1"></colgroup><colgroup id="TBL-7-2g"><col 
id="TBL-7-2"></colgroup><colgroup id="TBL-7-3g"><col 
id="TBL-7-3"></colgroup><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-1-1"  
class="td11"> output                  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-1-2"  
class="td11"> output action  </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-1-3"  
class="td11"> <!--l. 1354--><p class="noindent" >output
  option                          </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-2-1"  
class="td11"> to standard out        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-2-2"  
class="td11">   &#x003E;stdout     </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-2-3"  
class="td11"> <!--l. 1359--><p class="noindent" >no
  meaning                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-3-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-3-1"  
class="td11"> to standard error      </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-3-2"  
class="td11">   &#x003E;stderr     </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-3-3"  
class="td11"> <!--l. 1363--><p class="noindent" >no
  meaning                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-4-1"  
class="td11"> to syslog                 </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-4-2"  
class="td11">   &#x003E;syslog     </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-4-3"  
class="td11"> <!--l. 1367--><p class="noindent" >syslog
  facility,
  can
  be:
  LOG_USER(default),
  LOG_LOCAL[0-7]
  <!--l. 1369--><p class="noindent" >This
  is
  required.                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-5-1"  
class="td11"> pipeline output        </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-5-2"  
class="td11">     | cat        </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-5-3"  
class="td11"> <!--l. 1373--><p class="noindent" >no
  meaning                       </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-6-1"  
class="td11"> to file                     </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-6-2"  
class="td11">  "(file path)"  </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-6-3"  
class="td11"> <!--l. 1377--><p class="noindent" >rotation.
  see
  <a 
href="#x1-270005.6">5.6<!--tex4ht:ref: sec:Rotation --></a>
  for
  detail
  <!--l. 1379--><p class="noindent" >10MB
  *
  3
  ~
  "press.#r.log"                </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-7-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-7-1"  
class="td11">
</td></tr><tr 
class="cline"><td><hr></td><td><hr></td><td></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-8-1"  
class="td11"> synchronous I/O file  </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-8-2"  
class="td11"> -"(file path)"  </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-8-3"  
class="td11"> <!--l. 1384--><p class="noindent" >                      </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-9-1"  
class="td11"> user-defined output   </td><td  style="white-space:nowrap; text-align:center;" id="TBL-7-9-2"  
class="td11">    $name      </td><td  style="white-space:wrap; text-align:left;" id="TBL-7-9-3"  
class="td11"> <!--l. 1387--><p class="noindent" >"path"
  (dynamic
  or
  static)
  of
  record
  function                        </td>
</tr><tr 
class="hline"><td><hr></td><td><hr></td><td><hr></td></tr><tr  
 style="vertical-align:baseline;" id="TBL-7-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-7-10-1"  
class="td11">                   </td></tr></table></div>
      <ul class="itemize1">
      <li class="itemize">stdout, stderr, syslog
      <!--l. 1393--><p class="noindent" >As the above table describes, only the syslog action has a meaningful output
                                                                                  
                                                                                  
      option and it must be set.
      <!--l. 1396--><p class="noindent" >Warning: NEVER use &#x003E;stdout or &#x003E;stderr when your program is a daemon process.
      A daemon process always closes its first file descriptor, and when &#x003E;stdout is set, zlog
      will output a log like this
      <!--l. 1399--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1399--><p class="noindent" ><span 
class="ectt-1200">write(STDOUT_FILENO,</span><span 
class="ectt-1200">&#x00A0;zlog_buf_str(a_thread-&#x003E;msg_buf),</span><span 
class="ectt-1200">&#x00A0;zlog_buf_len(a_thread-&#x003E;msg_buf))</span></dd></dl>
      <!--l. 1402--><p class="noindent" >What will happen then? The log will be written to the file whose fd is now 1. I have
      received mail from someone who said zlog as a daemon wrote logs to the
      configuration file. So remember, daemon processes should not set any rule
      output to stdout, or stderr. It will generate undefined behavior. If you
      still want output logs to console when stdout is closed, use "/dev/tty"
      instead.
      </li>
      <li class="itemize">pipeline output
      <!--l. 1410--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1410--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;|</span><span 
class="ectt-1200">&#x00A0;/usr/bin/cronolog</span><span 
class="ectt-1200">&#x00A0;/www/logs/example_%Y%m%d.log</span><span 
class="ectt-1200">&#x00A0;;</span><span 
class="ectt-1200">&#x00A0;normal</span></dd></dl>
      <!--l. 1413--><p class="noindent" >This is an example of how zlog pipelines its output to cronolog. The implementation
      is simple. popen("/usr/bin/cronolog /www/logs/example_%Y%m%d.log","w") is
      called at zlog_init(), and forward logs will be written to the open descriptor in the
      "normal" format. Writing through pipeline and cronnolog is faster than dynamic file
      of zlog, as there is no need to open and close file descripter each time when logs are
      written to a pipe.
      <!--l. 1420--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1420--><p class="noindent" ><span 
class="ectt-1200">[rules]</span><span 
class="ectt-1200">&#x00A0;</span>
                                                                                  
                                                                                  
           <!--l. 1423--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <span 
class="ectt-1200">"press%d(%Y%m%d).log"</span>
           <!--l. 1425--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;10</span><span 
class="ectt-1200">&#x00A0;100000</span>
           <!--l. 1427--><p class="noindent" ><span 
class="ectt-1200">real</span>
           <span 
class="ectt-1200">0m4.240s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1429--><p class="noindent" ><span 
class="ectt-1200">user</span>
           <span 
class="ectt-1200">0m2.500s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1431--><p class="noindent" ><span 
class="ectt-1200">sys</span>
           <span 
class="ectt-1200">0m5.460s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1433--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1435--><p class="noindent" ><span 
class="ectt-1200">[rules]</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1437--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;|</span><span 
class="ectt-1200">&#x00A0;/usr/bin/cronolog</span><span 
class="ectt-1200">&#x00A0;press%Y%m%d.log</span>
           <!--l. 1439--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;10</span><span 
class="ectt-1200">&#x00A0;100000</span>
           <!--l. 1441--><p class="noindent" ><span 
class="ectt-1200">real</span>
           <span 
class="ectt-1200">0m1.911s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1443--><p class="noindent" ><span 
class="ectt-1200">user</span>
           <span 
class="ectt-1200">0m1.980s</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1445--><p class="noindent" ><span 
class="ectt-1200">sys</span>
           <span 
class="ectt-1200">0m1.470s</span></dd></dl>
      <!--l. 1447--><p class="noindent" >There are some limitations when using pipeline output:
           <ul class="itemize2">
           <li class="itemize">POSIX.1-2001 says that write(2)s of less than PIPE_BUF bytes must be
           atomic, On Linux, PIPE_BUF is 4096 bytes.
           </li>
           <li class="itemize">When  a  single  log  is  longer  than  PIPE_BUF,  and  multiple  processes
           write logs through one pipe (parent calls zlog_init(), and forks many child
           processes), log interlacing will occur.
           </li>
           <li class="itemize">Unrelated multiple processes can start multiple cronolog processes and
           write  to  the  same  log  file.  Even  if  a  single  log  is  not  longer  than
           PIPE_BUF, multiple cronologs will cause log interlace. As cronologs read
           log continuously, it doesn&#8217;t know where is the split between log entries.</li></ul>
      <!--l. 1460--><p class="noindent" >In summary, pipeline to a single log file:
           <ul class="itemize2">
           <li class="itemize">Single process writing, no limitation for length of one log. Multi-threads
                                                                                  
                                                                                  
           in one process, atomic writing is already assured by zlog.
           </li>
           <li class="itemize">Related multiple processes, the length of one log should not longer than
           PIPE_BUF.
           </li>
           <li class="itemize">Unrelated multiple processes, no matter how long a single log is, will cause
           interlace and is not safe.</li></ul>
      </li>
      <li class="itemize">file
           <ul class="itemize2">
           <li class="itemize">file path
           <!--l. 1474--><p class="noindent" >can be absolute file path or relative file path. It is quoted by double
           quotation marks. <span 
class="ecti-1200">Conversion pattern </span>can be used in file path. If the file
           path is "%E(HOME)/log/out.log" and the program environment $HOME
           is /home/harry, then the log file will be /home/harry/log/output.log. See
           <a 
href="#x1-190005.4">5.4<!--tex4ht:ref: sec:Conversion-pattern --></a> for more details.
           <!--l. 1481--><p class="noindent" >file of zlog is powerful, for example
               <ol  class="enumerate1" >
               <li 
  class="enumerate" id="x1-26002x1">output to named pipe(FIFO), which must be created by mkfifo(1)
               before use
               <!--l. 1486--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 1486--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/tmp/pipefile"</span></dd></dl>
               </li>
               <li 
  class="enumerate" id="x1-26004x2">output to null, do nothing at all
               <!--l. 1491--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 1491--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/dev/null"</span></dd></dl>
               </li>
               <li 
  class="enumerate" id="x1-26006x3">output to console, in any case
                                                                                  
                                                                                  
               <!--l. 1496--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 1496--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/dev/tty"</span></dd></dl>
               </li>
               <li 
  class="enumerate" id="x1-26008x4">output a log to each tid, in the directory where the process running
               <!--l. 1501--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 1501--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%T.log"</span></dd></dl>
               </li>
               <li 
  class="enumerate" id="x1-26010x5">output to file with pid name, every day, in $HOME/log directory, rotate log
               at 1GB, keep 5 log files
               <!--l. 1507--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 1507--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%E(HOME)/log/aa.%p.%d(%F).log",1GB</span><span 
class="ectt-1200">&#x00A0;*</span><span 
class="ectt-1200">&#x00A0;5</span></dd></dl>
               </li>
               <li 
  class="enumerate" id="x1-26012x6">each category of aa_ super category, output log with category
               name</li></ol>
           <!--l. 1512--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 1512--><p class="noindent" ><span 
class="ectt-1200">aa_.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"/var/log/%c.log"</span></dd></dl>
           </li>
           <li class="itemize">rotate action
           <!--l. 1517--><p class="noindent" >controls log file size and count. zlog rotates the log file when the file exceeds
           this value. For example, let the action be
           <!--l. 1519--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
                                                                                  
                                                                                  
               <!--l. 1519--><p class="noindent" ><span 
class="ectt-1200">"%E(HOME)/log/out.log",1M*3</span></dd></dl>
           <!--l. 1522--><p class="noindent" >and after out.log is filled to 1M, the rotation is
           <!--l. 1523--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 1523--><p class="noindent" ><span 
class="ectt-1200">out.log</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;out.log.1</span>
               <!--l. 1526--><p class="noindent" ><span 
class="ectt-1200">out.log(new</span><span 
class="ectt-1200">&#x00A0;create)</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           <!--l. 1528--><p class="noindent" >If the new log is full again, the rotation is
           <!--l. 1529--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 1529--><p class="noindent" ><span 
class="ectt-1200">out.log.1</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;out.log.2</span>
               <!--l. 1532--><p class="noindent" ><span 
class="ectt-1200">out.log</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;out.log.1</span>
               <!--l. 1534--><p class="noindent" ><span 
class="ectt-1200">out.log(new</span><span 
class="ectt-1200">&#x00A0;create)</span></dd></dl>
           <!--l. 1536--><p class="noindent" >The next rotation will delete the oldest log, as *3 means just allows 3 file
           exist
           <!--l. 1538--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 1538--><p class="noindent" ><span 
class="ectt-1200">unlink(out.log.2)</span>
               <!--l. 1541--><p class="noindent" ><span 
class="ectt-1200">out.log.1</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;out.log.2</span>
               <!--l. 1543--><p class="noindent" ><span 
class="ectt-1200">out.log</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;out.log.1</span>
               <!--l. 1545--><p class="noindent" ><span 
class="ectt-1200">out.log(new</span><span 
class="ectt-1200">&#x00A0;create)</span></dd></dl>
           <!--l. 1547--><p class="noindent" >So the oldest log has the biggest serial number. If *3 is not specified, it means
           rotation will continue and no old log will be deleted.
           </li>
           <li class="itemize">synchronous I/O file
           <!--l. 1551--><p class="noindent" >Putting a minus sign &#8217;-&#8217; sets the synchronous I/O option. log file is opened with
           O_SYNC and every single log action will wait until the Operating System
           writes data to disk. It is painfully slow:
           <!--l. 1554--><p class="noindent" >
                                                                                  
                                                                                  
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 1554--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;100</span><span 
class="ectt-1200">&#x00A0;1000</span>
               <!--l. 1557--><p class="noindent" ><span 
class="ectt-1200">real</span>
               <span 
class="ectt-1200">0m0.732s</span>
               <!--l. 1559--><p class="noindent" ><span 
class="ectt-1200">user</span>
               <span 
class="ectt-1200">0m1.030s</span>
               <!--l. 1561--><p class="noindent" ><span 
class="ectt-1200">sys</span>
               <span 
class="ectt-1200">&#x00A0;0m1.080s</span>
               <!--l. 1563--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;time</span><span 
class="ectt-1200">&#x00A0;./test_press_zlog</span><span 
class="ectt-1200">&#x00A0;100</span><span 
class="ectt-1200">&#x00A0;1000</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#</span><span 
class="ectt-1200">&#x00A0;synchronous</span><span 
class="ectt-1200">&#x00A0;I/O</span><span 
class="ectt-1200">&#x00A0;open</span>
               <!--l. 1565--><p class="noindent" ><span 
class="ectt-1200">real</span>
               <span 
class="ectt-1200">0m20.646s</span>
               <!--l. 1567--><p class="noindent" ><span 
class="ectt-1200">user</span>
               <span 
class="ectt-1200">0m2.570s</span>
               <!--l. 1569--><p class="noindent" ><span 
class="ectt-1200">sys</span>
               <span 
class="ectt-1200">&#x00A0;0m6.950s</span></dd></dl>
           </li></ul>
      </li>
      <li class="itemize">format name
      <!--l. 1574--><p class="noindent" >It is optional. If not set, use zlog default format in global setting, which
      is:
      <!--l. 1576--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1576--><p class="noindent" ><span 
class="ectt-1200">[global]</span>
           <!--l. 1579--><p class="noindent" ><span 
class="ectt-1200">default</span><span 
class="ectt-1200">&#x00A0;format</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%d</span><span 
class="ectt-1200">&#x00A0;%V</span><span 
class="ectt-1200">&#x00A0;[%p:%F:%L]</span><span 
class="ectt-1200">&#x00A0;%m%n"</span></dd></dl>
      </li>
      <li class="itemize">see <a 
href="#x1-410007.4">7.4<!--tex4ht:ref: sec:User-defined-Output --></a> for more details for $.</li></ul>
<!--l. 1584--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.6   </span> <a 
 id="x1-270005.6"></a>Rotation</h3>
                                                                                  
                                                                                  
<!--l. 1586--><p class="noindent" >Why rotation? I have see more than once in a production environment, that the
hard disk is full of logs and causes the system to stop working, or a single log
file is too big to open or grep. Several ways to rotate and archive log files are
possible:
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-27002x1">Split log by date or time.
      <!--l. 1593--><p class="noindent" >For example, generate one log file per day.
      <!--l. 1594--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1594--><p class="noindent" ><span 
class="ectt-1200">aa.2012-08-02.log</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1597--><p class="noindent" ><span 
class="ectt-1200">aa.2012-08-03.log</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1599--><p class="noindent" ><span 
class="ectt-1200">aa.2012-08-04.log</span></dd></dl>
      <!--l. 1601--><p class="noindent" >In this case, the system administrator knows how much log will be produced one day.
      The sys admin is able to search log files based on the day. The best way to make this
      split is to let the zlog library do it. Another choice is using cronosplit to analyse the
      content of log file and split it. A bad way is using crontab+logrotate to daily move
      log files, which is not accurate, some logs will be put into the file for the previous
      day.
      <!--l. 1609--><p class="noindent" >Using zlog, there is no need for external rotate action to complete the job. Setting
      time in the log file name works:
      <!--l. 1611--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1611--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"aa.%d(%F).log"</span></dd></dl>
      <!--l. 1614--><p class="noindent" >or using cronolog for faster performace:
      <!--l. 1615--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1615--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;|</span><span 
class="ectt-1200">&#x00A0;cronolog</span><span 
class="ectt-1200">&#x00A0;aa.%F.log</span></dd></dl>
                                                                                  
                                                                                  
      </li>
      <li 
  class="enumerate" id="x1-27004x2">Split log by size.
      <!--l. 1620--><p class="noindent" >Always suitable for development use. In this case, the program generates a lot of logs
      in a short period. But the text editor might not be able to open big files quickly.
      Although the split can be done using split tools afterwards, this requires extra
      steps. So a good way is to let the logging library do the rotation. There are
      two ways of rotation, as nlog describes, Sequence and Rolling. In case of
      Sequence:
      <!--l. 1626--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1626--><p class="noindent" ><span 
class="ectt-1200">aa.log</span><span 
class="ectt-1200">&#x00A0;(new)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1629--><p class="noindent" ><span 
class="ectt-1200">aa.log.2</span><span 
class="ectt-1200">&#x00A0;(less</span><span 
class="ectt-1200">&#x00A0;new)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1631--><p class="noindent" ><span 
class="ectt-1200">aa.log.1</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1633--><p class="noindent" ><span 
class="ectt-1200">aa.log.0</span><span 
class="ectt-1200">&#x00A0;(old)</span></dd></dl>
      <!--l. 1635--><p class="noindent" >And in case of Rolling:
      <!--l. 1636--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1636--><p class="noindent" ><span 
class="ectt-1200">aa.log</span><span 
class="ectt-1200">&#x00A0;(new)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1639--><p class="noindent" ><span 
class="ectt-1200">aa.log.0</span><span 
class="ectt-1200">&#x00A0;(less</span><span 
class="ectt-1200">&#x00A0;new)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1641--><p class="noindent" ><span 
class="ectt-1200">aa.log.1</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1643--><p class="noindent" ><span 
class="ectt-1200">aa.log.2</span><span 
class="ectt-1200">&#x00A0;(old)</span></dd></dl>
      <!--l. 1645--><p class="noindent" >It&#8217;s hard to say which one is most suitable.
      <!--l. 1647--><p class="noindent" >If only some of the newest logs are useful to developers, logging library should do the
      cleanup work and delete the old log files. Some external tools can&#8217;t find out which
      files are older.
      <!--l. 1651--><p class="noindent" >The simplest rotation configuration for zlog is:
      <!--l. 1652--><p class="noindent" >
           <dl class="list2"><dt class="list">
                                                                                  
                                                                                  
           </dt><dd 
class="list">
           <!--l. 1652--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"aa.log",</span><span 
class="ectt-1200">&#x00A0;10MB</span></dd></dl>
      <!--l. 1655--><p class="noindent" >It is Rolling. When aa.log is larger than 10MB, zlog will rename file like
      this:
      <!--l. 1657--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1657--><p class="noindent" ><span 
class="ectt-1200">aa.log.2</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;aa.log.3</span>
           <!--l. 1660--><p class="noindent" ><span 
class="ectt-1200">aa.log.1</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;aa.log.2</span>
           <!--l. 1662--><p class="noindent" ><span 
class="ectt-1200">aa.log.0</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;aa.log.1</span>
           <!--l. 1664--><p class="noindent" ><span 
class="ectt-1200">aa.log</span><span 
class="ectt-1200">&#x00A0;-&#x003E;</span><span 
class="ectt-1200">&#x00A0;aa.log.0</span></dd></dl>
      <!--l. 1666--><p class="noindent" >The configuration can be more complex:
      <!--l. 1667--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1667--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"aa.log",</span><span 
class="ectt-1200">&#x00A0;10MB</span><span 
class="ectt-1200">&#x00A0;*</span><span 
class="ectt-1200">&#x00A0;0</span><span 
class="ectt-1200">&#x00A0;~</span><span 
class="ectt-1200">&#x00A0;"aa.log.#r"</span></dd></dl>
      <!--l. 1670--><p class="noindent" >The 1st argument after the file name says when rotation will be triggered, in
      size.
      <!--l. 1673--><p class="noindent" >The 2nd argument after the file name says how many archive files will be kept, (0
      means keep all).
      <!--l. 1676--><p class="noindent" >The 3rd argument after the file name shows the archive file name. #r is a sequence
      number for archive files. r is short for Rolling, and #s is short for sequence. Archive
      file name must contain one of #r or #s.
      </li>
      <li 
  class="enumerate" id="x1-27006x3">Split log by size, and add time tag to archive file.
      <!--l. 1682--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1682--><p class="noindent" ><span 
class="ectt-1200">aa.log</span><span 
class="ectt-1200">&#x00A0;</span>
                                                                                  
                                                                                  
           <!--l. 1685--><p class="noindent" ><span 
class="ectt-1200">aa.log-20070305.00.log</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1687--><p class="noindent" ><span 
class="ectt-1200">aa.log-20070501.00.log</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 1689--><p class="noindent" ><span 
class="ectt-1200">aa.log-20070501.01.log</span>
           <!--l. 1691--><p class="noindent" ><span 
class="ectt-1200">aa.log-20071008.00.log</span></dd></dl>
      <!--l. 1693--><p class="noindent" >In this case, the log file is not usually viewed frequently, and is likely checked once a
      day. Of course, when one day&#8217;s log is more than 100MB, you should consider storing
      in two files and add postfix numbers. For example if the date is used as part of the
      pattern (like 20070501):
      <!--l. 1698--><p class="noindent" >The configuration of zlog is:
      <!--l. 1699--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 1699--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"aa.log",</span><span 
class="ectt-1200">&#x00A0;100MB</span><span 
class="ectt-1200">&#x00A0;~</span><span 
class="ectt-1200">&#x00A0;"aa-%d(%Y%m%d).#2s.log"</span>
           <!--l. 1702--><p class="noindent" ><span 
class="ectt-1200">Do</span><span 
class="ectt-1200">&#x00A0;rotation</span><span 
class="ectt-1200">&#x00A0;every</span><span 
class="ectt-1200">&#x00A0;100MB.</span><span 
class="ectt-1200">&#x00A0;The</span><span 
class="ectt-1200">&#x00A0;archive</span><span 
class="ectt-1200">&#x00A0;file</span><span 
class="ectt-1200">&#x00A0;name</span><span 
class="ectt-1200">&#x00A0;also</span><span 
class="ectt-1200">&#x00A0;supports</span><span 
class="ectt-1200">&#x00A0;conversion</span><span 
class="ectt-1200">&#x00A0;strings.</span><span 
class="ectt-1200">&#x00A0;#2s</span><span 
class="ectt-1200">&#x00A0;means</span><span 
class="ectt-1200">&#x00A0;the</span><span 
class="ectt-1200">&#x00A0;sequence</span><span 
class="ectt-1200">&#x00A0;number</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;at</span><span 
class="ectt-1200">&#x00A0;least</span><span 
class="ectt-1200">&#x00A0;2</span><span 
class="ectt-1200">&#x00A0;bytes</span><span 
class="ectt-1200">&#x00A0;wide.</span><span 
class="ectt-1200">&#x00A0;Sequence</span><span 
class="ectt-1200">&#x00A0;from</span><span 
class="ectt-1200">&#x00A0;00.</span><span 
class="ectt-1200">&#x00A0;That&#8217;s</span><span 
class="ectt-1200">&#x00A0;the</span><span 
class="ectt-1200">&#x00A0;most</span><span 
class="ectt-1200">&#x00A0;complex</span><span 
class="ectt-1200">&#x00A0;way</span><span 
class="ectt-1200">&#x00A0;to</span><span 
class="ectt-1200">&#x00A0;archive</span><span 
class="ectt-1200">&#x00A0;in</span><span 
class="ectt-1200">&#x00A0;zlog.</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-27008x4">Compress, move and delete old archive.
      <!--l. 1706--><p class="noindent" >Compress should not be done by the logging library, because compress need time and
      CPU. The mission of the logging library is to cooperate with compress
      programs.
      <!--l. 1710--><p class="noindent" >For the 3 ways to split logs, way 1 and way 3 are easy to manage. It is easy to find
      old log file by name or by modify time. And then compress, move and delete old log
      files by crontab and shell.
      <!--l. 1714--><p class="noindent" >For second way, compress is useless, delete is needed and zlog already supports
      it.
      <!--l. 1717--><p class="noindent" >If you really want to rotate and compress log file at the same time, I suggest
      logrotate. It is an independent program and will not confuse the situation.
      </li>
      <li 
  class="enumerate" id="x1-27010x5">zlog support for external tools like logrotate.</li></ol>
<!--l. 1722--><p class="noindent" >The rotation support of zlog is very powerful, still there are several cases zlog can not handle.
Like rotation by time, before or after rotation call some user-defined shells. That will make
zlog too complex.
                                                                                  
                                                                                  
<!--l. 1726--><p class="indent" >   Under these circumstances, consider using external tools like logrotate. On linux, the
problem is that when a tool renames the log file, the working process which uses an inode
to reference the file will not automatically reopen the new file. The standard way is send
a signal to the program and let it reopen the file. For syslogd the command
is:
<!--l. 1732--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1732--><p class="noindent" ><span 
class="ectt-1200">kill</span><span 
class="ectt-1200">&#x00A0;-SIGHUP</span><span 
class="ectt-1200">&#x00A0;&#8216;cat</span><span 
class="ectt-1200">&#x00A0;/var/run/syslogd.pid&#8216;</span></dd></dl>
<!--l. 1735--><p class="noindent" >For zlog as a library, it is not good to receive signals. zlog provide zlog_reload(), which
reloads the configuration file and reopens all log files. So if you write a program and want
to reopen a log file manually, you can write some code to do the job like this: after
receiving a signal or command from client, call zlog_reload().
<!--l. 1741--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">5.7   </span> <a 
 id="x1-280005.7"></a>Configure File Tools</h3>
<!--l. 1742--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1742--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;zlog-chk-conf</span><span 
class="ectt-1200">&#x00A0;-h</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1745--><p class="noindent" ><span 
class="ectt-1200">Useage:</span><span 
class="ectt-1200">&#x00A0;zlog-chk-conf</span><span 
class="ectt-1200">&#x00A0;[conf</span><span 
class="ectt-1200">&#x00A0;files]...</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1747--><p class="noindent" ><span 
class="ectt-1200">-q,</span>
      <span 
class="ectt-1200">suppress</span><span 
class="ectt-1200">&#x00A0;non-error</span><span 
class="ectt-1200">&#x00A0;message</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1749--><p class="noindent" ><span 
class="ectt-1200">-h,</span>
      <span 
class="ectt-1200">show</span><span 
class="ectt-1200">&#x00A0;help</span><span 
class="ectt-1200">&#x00A0;message</span></dd></dl>
<!--l. 1751--><p class="noindent" >zlog-chk-conf tries to read configuration files, check their syntax, and output to screen
whether it is correct or not. I suggest using this tool each time you create or change a
configuration file. It will output like this
<!--l. 1755--><p class="noindent" >
                                                                                  
                                                                                  
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1755--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;./zlog-chk-conf</span><span 
class="ectt-1200">&#x00A0;zlog.conf</span>
      <!--l. 1758--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:rule.c:391)</span><span 
class="ectt-1200">&#x00A0;sscanf</span><span 
class="ectt-1200">&#x00A0;[aaa]</span><span 
class="ectt-1200">&#x00A0;fail,</span><span 
class="ectt-1200">&#x00A0;category</span><span 
class="ectt-1200">&#x00A0;or</span><span 
class="ectt-1200">&#x00A0;level</span><span 
class="ectt-1200">&#x00A0;is</span><span 
class="ectt-1200">&#x00A0;null</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1760--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:conf.c:155)</span><span 
class="ectt-1200">&#x00A0;zlog_rule_new</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;[aaa]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1762--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:conf.c:258)</span><span 
class="ectt-1200">&#x00A0;parse</span><span 
class="ectt-1200">&#x00A0;configure</span><span 
class="ectt-1200">&#x00A0;file[zlog.conf]</span><span 
class="ectt-1200">&#x00A0;line[126]</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1764--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:conf.c:306)</span><span 
class="ectt-1200">&#x00A0;zlog_conf_read_config</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1766--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:conf.c:366)</span><span 
class="ectt-1200">&#x00A0;zlog_conf_build</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1768--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:zlog.c:66)</span><span 
class="ectt-1200">&#x00A0;conf_file[zlog.conf],</span><span 
class="ectt-1200">&#x00A0;init</span><span 
class="ectt-1200">&#x00A0;conf</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1770--><p class="noindent" ><span 
class="ectt-1200">03-08</span><span 
class="ectt-1200">&#x00A0;15:35:44</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10595:zlog.c:131)</span><span 
class="ectt-1200">&#x00A0;zlog_init_inner[zlog.conf]</span><span 
class="ectt-1200">&#x00A0;fail</span>
      <!--l. 1772--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 1774--><p class="noindent" ><span 
class="ectt-1200">---[zlog.conf]</span><span 
class="ectt-1200">&#x00A0;syntax</span><span 
class="ectt-1200">&#x00A0;error,</span><span 
class="ectt-1200">&#x00A0;see</span><span 
class="ectt-1200">&#x00A0;error</span><span 
class="ectt-1200">&#x00A0;message</span><span 
class="ectt-1200">&#x00A0;above</span></dd></dl>
<!--l. 1776--><p class="noindent" >This example tells you that [aaa] is not a correct rule and that line 126 in the configuration
file is wrong. Later failure reports result from that fundamental failure.
<!--l. 1779--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1779--><p class="noindent" ></dd></dl>
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-290006"></a>zlog API</h2>
<!--l. 1784--><p class="noindent" >All zlog APIs are thread safe. To use them, you just need to
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 1785--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span></dd></dl>
   <h3 class="sectionHead"><span class="titlemark">6.1   </span> <a 
 id="x1-300006.1"></a>initialize and finish</h3>
<!--l. 1790--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 1791--><p class="noindent" >
           <!--l. 1793--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1793--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;zlog_init(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">confpath</span></span><span 
class="ectt-1200">);</span>
                <!--l. 1796--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;zlog_reload(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">confpath</span></span><span 
class="ectt-1200">);</span>
                <!--l. 1798--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;zlog_fini(void);</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 1800--><p class="noindent" >
           <!--l. 1802--><p class="noindent" >zlog_init() reads configuration from the file <span class="uline">confpath</span>. If <span class="uline">confpath</span> is NULL, it
           looks for the environment variable ZLOG_CONF_PATH to find the
           configuration file. If $ZLOG_CONF_PATH is NULL also, all logs will
           be output to stdout with an internal format. Only the first call to
           zlog_init() per process is effective, subsequent calls will fail and do
           nothing.
           <!--l. 1809--><p class="noindent" >zlog_reload() is designed to reload the configuration file. From the <span class="uline">confpath</span> it
           re-calculates the category-rule relationships, rebuilds thread buffers, and resets
           user-defined output function rules. It can be called at runtime when the
           configuration file is changed or you wish to use another configuration file. It
           can be called any number of times. If <span class="uline">confpath</span> is NULL, it reloads the last
                                                                                  
                                                                                  
           configuration file that zlog_init() or zlog_reload() specified. If zlog_reload()
           failed, the current configuration in memory will remain unchanged. So
           zlog_reload() is atomic.
           <!--l. 1819--><p class="noindent" >zlog_fini() releases all zlog API memory and closes opened files. It can be
           called any number of times.
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 1821--><p class="noindent" >VALUE
           <!--l. 1823--><p class="noindent" >On success , zlog_init() and zlog_reload() return zero. On error, zlog_init()
           and zlog_reload() return -1, and a detailed error log will be recorded to the log
           file indicated by ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 1828--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.2   </span> <a 
 id="x1-310006.2"></a>category operation</h3>
<!--l. 1829--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 1830--><p class="noindent" >
           <!--l. 1832--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1832--><p class="noindent" ><span 
class="ectt-1200">typedef</span><span 
class="ectt-1200">&#x00A0;struct</span><span 
class="ectt-1200">&#x00A0;zlog_category_s</span><span 
class="ectt-1200">&#x00A0;zlog_category_t;</span>
                <!--l. 1835--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*zlog_get_category(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">cname</span></span><span 
class="ectt-1200">);</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 1837--><p class="noindent" >
           <!--l. 1839--><p class="noindent" >zlog_get_category() gets a category from zlog&#8217;s category_table for a future
           log action. If the category cname does not exist it will be created. Then zlog
           goes through all rules as determined by the configuration. It returns a pointer
           to matched rules corresponding to <span class="uline">cname</span>.
           <!--l. 1845--><p class="noindent" >This is how category string in rules matches <span class="uline">cname</span>:
                                                                                  
                                                                                  
                <ol  class="enumerate1" >
                <li 
  class="enumerate" id="x1-31002x1">* matches all <span class="uline">cname</span>.
                </li>
                <li 
  class="enumerate" id="x1-31004x2">category   string   which   ends   with   underscore   "_"   matches
                super-category  and  sub-categories.  For  example,  "aa_"  matches
                <span class="uline">cname</span> like "aa", "aa_", "aa_bb", "aa_bb_cc".
                </li>
                <li 
  class="enumerate" id="x1-31006x3">category string which does not end with underscore "_"matches
                <span class="uline">cname</span> accurately. For example, "aa_bb" matches only a <span class="uline">cname</span> of
                "aa_bb".
                </li>
                <li 
  class="enumerate" id="x1-31008x4">! matches <span class="uline">cname</span> that has no rule matched.</li></ol>
           <!--l. 1857--><p class="noindent" >The rules for each category will be automatically re-calculated when
           zlog_reload() is called. No need to worry about category&#8217;s memory release,
           zlog_fini() will clean up at the end.
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 1860--><p class="noindent" >VALUE
           <!--l. 1862--><p class="noindent" >On success, return the address of zlog_category_t. On error, return NULL,
           and a detailed error log will be recorded to the log file indicated by
           ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 1867--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.3   </span> <a 
 id="x1-320006.3"></a>log functions and macros</h3>
<!--l. 1868--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 1869--><p class="noindent" >
           <!--l. 1871--><p class="noindent" >
                                                                                  
                                                                                  
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1871--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;zlog(zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">category</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1874--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1876--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1878--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1880--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">format</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;...);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1882--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;vzlog(zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">category</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1884--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1886--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1888--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1890--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">format</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;va_list</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">args</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1892--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;hzlog(zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">category</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1894--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1896--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1898--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 1900--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;void</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">buf</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">buflen</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span>
                </dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 1903--><p class="noindent" >
           <!--l. 1905--><p class="noindent" >These 3 functions are the real log functions producing user messages, which
           correspond to %m is configuration file entries. <span class="uline">category</span> comes from
           zlog_get_category() described above.
           <!--l. 1909--><p class="noindent" >zlog() and vzlog() produce output according to a <span class="uline">format</span> like printf(3) and
           vprintf(3).
           <!--l. 1912--><p class="noindent" >vzlog() is equivalent to zlog(), except that it is called with a va_list instead of
           a variable number of arguments. vzlog() invokes the va_copy macro, the value
           of <span class="uline">args</span> remain unchanged after the call. See stdarg(3).
           <!--l. 1917--><p class="noindent" >hzlog() is a little different, it produce output like this, the hexadecimal
           representation of <span class="uline">buf</span> and output len is <span class="uline">buf_len</span>
           <!--l. 1920--><p class="noindent" >
                <dl class="list2"><dt class="list">
                                                                                  
                                                                                  
                </dt><dd 
class="list">
                <!--l. 1920--><p class="noindent" ><span 
class="ectt-1200">hex_buf_len=[5365]</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1923--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;0</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;1</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;2</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;3</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;4</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;5</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;6</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;7</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;8</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;9</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;A</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;B</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;C</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;D</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;E</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;F</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;0123456789ABCDEF</span>
                <!--l. 1925--><p class="noindent" ><span 
class="ectt-1200">0000000001</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;23</span><span 
class="ectt-1200">&#x00A0;21</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;2f</span><span 
class="ectt-1200">&#x00A0;62</span><span 
class="ectt-1200">&#x00A0;69</span><span 
class="ectt-1200">&#x00A0;6e</span><span 
class="ectt-1200">&#x00A0;2f</span><span 
class="ectt-1200">&#x00A0;62</span><span 
class="ectt-1200">&#x00A0;61</span><span 
class="ectt-1200">&#x00A0;73</span><span 
class="ectt-1200">&#x00A0;68</span><span 
class="ectt-1200">&#x00A0;0a</span><span 
class="ectt-1200">&#x00A0;0a</span><span 
class="ectt-1200">&#x00A0;23</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;#!</span><span 
class="ectt-1200">&#x00A0;/bin/bash..#</span>
                <!--l. 1927--><p class="noindent" ><span 
class="ectt-1200">0000000002</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;74</span><span 
class="ectt-1200">&#x00A0;65</span><span 
class="ectt-1200">&#x00A0;73</span><span 
class="ectt-1200">&#x00A0;74</span><span 
class="ectt-1200">&#x00A0;5f</span><span 
class="ectt-1200">&#x00A0;68</span><span 
class="ectt-1200">&#x00A0;65</span><span 
class="ectt-1200">&#x00A0;78</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;2d</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;74</span><span 
class="ectt-1200">&#x00A0;65</span><span 
class="ectt-1200">&#x00A0;6d</span><span 
class="ectt-1200">&#x00A0;70</span><span 
class="ectt-1200">&#x00A0;6f</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;test_hex</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;tempo</span>
                <!--l. 1929--><p class="noindent" ><span 
class="ectt-1200">0000000003</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;72</span><span 
class="ectt-1200">&#x00A0;61</span><span 
class="ectt-1200">&#x00A0;72</span><span 
class="ectt-1200">&#x00A0;79</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;77</span><span 
class="ectt-1200">&#x00A0;72</span><span 
class="ectt-1200">&#x00A0;61</span><span 
class="ectt-1200">&#x00A0;70</span><span 
class="ectt-1200">&#x00A0;70</span><span 
class="ectt-1200">&#x00A0;65</span><span 
class="ectt-1200">&#x00A0;72</span><span 
class="ectt-1200">&#x00A0;20</span><span 
class="ectt-1200">&#x00A0;73</span><span 
class="ectt-1200">&#x00A0;63</span><span 
class="ectt-1200">&#x00A0;72</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;rary</span><span 
class="ectt-1200">&#x00A0;wrapper</span><span 
class="ectt-1200">&#x00A0;scr</span></dd></dl>
           <!--l. 1931--><p class="noindent" >The parameter <span class="uline">file</span> and <span class="uline">line</span> are usually filled by the __FILE__ and
           __LINE__ macros. These indicate where the log event happened. The
           parameter <span class="uline">func</span> is filled with __func__ or __FUNCTION__, if the compiler
           supports it, otherwise it will be filled with "&#x003C;unknown&#x003E;".
           <!--l. 1937--><p class="noindent" ><span class="uline">level</span> is an int in the current level list, which defaults to:
           <!--l. 1939--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1939--><p class="noindent" ><span 
class="ectt-1200">typedef</span><span 
class="ectt-1200">&#x00A0;enum</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1942--><p class="noindent" >
                    <dl class="list3"><dt class="list">
                    </dt><dd 
class="list">
                    <!--l. 1942--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_DEBUG</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;20,</span>
                    <!--l. 1945--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_INFO</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;40,</span>
                    <!--l. 1947--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_NOTICE</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;60,</span>
                    <!--l. 1949--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_WARN</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;80,</span>
                    <!--l. 1951--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_ERROR</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;100,</span>
                    <!--l. 1953--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_FATAL</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;120</span></dd></dl>
                <!--l. 1955--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;zlog_level;</span></dd></dl>
           <!--l. 1957--><p class="noindent" >Each fuction has its macros for easy use. For example,
           <!--l. 1958--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1958--><p class="noindent" ><span 
class="ectt-1200">#define</span><span 
class="ectt-1200">&#x00A0;zlog_fatal(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args...)</span><span 
class="ectt-1200">&#x00A0;\</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1961--><p class="noindent" ><span 
class="ectt-1200">zlog(cat,</span><span 
class="ectt-1200">&#x00A0;__FILE__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__FILE__)-1,</span><span 
class="ectt-1200">&#x00A0;\</span>
                                                                                  
                                                                                  
                <!--l. 1963--><p class="noindent" ><span 
class="ectt-1200">__func__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__func__)-1,</span><span 
class="ectt-1200">&#x00A0;__LINE__,</span><span 
class="ectt-1200">&#x00A0;\</span>
                <!--l. 1965--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_FATAL,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;##args)</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           <!--l. 1967--><p class="noindent" >The full list of macros is:
           <!--l. 1968--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 1968--><p class="noindent" ><span 
class="ectt-1200">/*</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;macros</span><span 
class="ectt-1200">&#x00A0;*/</span>
                <!--l. 1971--><p class="noindent" ><span 
class="ectt-1200">/*</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;macros</span><span 
class="ectt-1200">&#x00A0;*/</span>
                <!--l. 1973--><p class="noindent" ><span 
class="ectt-1200">zlog_fatal(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1975--><p class="noindent" ><span 
class="ectt-1200">zlog_error(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1977--><p class="noindent" ><span 
class="ectt-1200">zlog_warn(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1979--><p class="noindent" ><span 
class="ectt-1200">zlog_notice(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1981--><p class="noindent" ><span 
class="ectt-1200">zlog_info(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1983--><p class="noindent" ><span 
class="ectt-1200">zlog_debug(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 1985--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 1987--><p class="noindent" ><span 
class="ectt-1200">/*</span><span 
class="ectt-1200">&#x00A0;vzlog</span><span 
class="ectt-1200">&#x00A0;macros</span><span 
class="ectt-1200">&#x00A0;*/</span>
                <!--l. 1989--><p class="noindent" ><span 
class="ectt-1200">vzlog_fatal(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 1991--><p class="noindent" ><span 
class="ectt-1200">vzlog_error(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 1993--><p class="noindent" ><span 
class="ectt-1200">vzlog_warn(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 1995--><p class="noindent" ><span 
class="ectt-1200">vzlog_notice(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 1997--><p class="noindent" ><span 
class="ectt-1200">vzlog_info(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 1999--><p class="noindent" ><span 
class="ectt-1200">vzlog_debug(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2001--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2003--><p class="noindent" ><span 
class="ectt-1200">/*</span><span 
class="ectt-1200">&#x00A0;hzlog</span><span 
class="ectt-1200">&#x00A0;macros</span><span 
class="ectt-1200">&#x00A0;*/</span>
                <!--l. 2005--><p class="noindent" ><span 
class="ectt-1200">hzlog_fatal(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2007--><p class="noindent" ><span 
class="ectt-1200">hzlog_error(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2009--><p class="noindent" ><span 
class="ectt-1200">hzlog_warn(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2011--><p class="noindent" ><span 
class="ectt-1200">hzlog_notice(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2013--><p class="noindent" ><span 
class="ectt-1200">hzlog_info(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2015--><p class="noindent" ><span 
class="ectt-1200">hzlog_debug(cat,</span><span 
class="ectt-1200">&#x00A0;buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 2017--><p class="noindent" >VALUE
           <!--l. 2019--><p class="noindent" >These functions return nothing. But if anything wrong happens, a
                                                                                  
                                                                                  
           detailed error log will be recorded to the log file indicated by
           ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 2023--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.4   </span> <a 
 id="x1-330006.4"></a>MDC operation</h3>
<!--l. 2024--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 2025--><p class="noindent" >
           <!--l. 2027--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2027--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;zlog_put_mdc(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">key</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">value</span></span><span 
class="ectt-1200">);</span>
                <!--l. 2030--><p class="noindent" ><span 
class="ectt-1200">char</span><span 
class="ectt-1200">&#x00A0;*zlog_get_mdc(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">key</span></span><span 
class="ectt-1200">);</span>
                <!--l. 2032--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;zlog_remove_mdc(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">key</span></span><span 
class="ectt-1200">);</span>
                <!--l. 2034--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;zlog_clean_mdc(void);</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 2036--><p class="noindent" >
           <!--l. 2038--><p class="noindent" >MDC (Mapped Diagnostic Context) is a thread key-value map, and has
           nothing to do with category.
           <!--l. 2041--><p class="noindent" ><span class="uline">key</span> and <span class="uline">value</span> are all strings, which should be no longer than
           MAXLEN_PATH(1024). If the input is longer than MAXLEN_PATH(1024),
           the input will be truncated.
           <!--l. 2045--><p class="noindent" >One thing you should remember is that the map bonds to a thread,
           thus if you set a key-value pair in one thread, it will not affect other
           threads.
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 2048--><p class="noindent" >VALUE
                                                                                  
                                                                                  
           <!--l. 2050--><p class="noindent" >zlog_put_mdc() returns 0 for success, -1 for fail. zlog_get_mdc() returns a
           pointer to <span class="uline">value</span> for success, NULL for fail or key not exist. If anything wrong
           happens, a detailed error log will be recorded to the log file indicated by
           ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 2056--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.5   </span> <a 
 id="x1-340006.5"></a>dzlog API</h3>
<!--l. 2057--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 2058--><p class="noindent" >
           <!--l. 2060--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2060--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;dzlog_init(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">confpath</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">cname</span></span><span 
class="ectt-1200">);</span>
                <!--l. 2063--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;dzlog_set_category(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">cname</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2065--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;dzlog(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2067--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2069--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2071--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">format</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;...);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2073--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;vdzlog(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2075--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2077--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2079--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">format</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;va_list</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">args</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2081--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;hdzlog(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">file</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">filelen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2083--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">func</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">funclen</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2085--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;long</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">line</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">level</span></span><span 
class="ectt-1200">,</span>
                <!--l. 2087--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;const</span><span 
class="ectt-1200">&#x00A0;void</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">buf</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">buflen</span></span><span 
class="ectt-1200">);</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 2089--><p class="noindent" >
                                                                                  
                                                                                  
           <!--l. 2091--><p class="noindent" >dzlog consists of simple functions that omit <span 
class="ecti-1200">zlog_category_t</span>. It uses a default
           category internally and puts the category under lock protection. It is thread
           safe also. Omitting the category means that users need not create,
           save, or transfer <span 
class="ecti-1200">zlog_category_t </span>variables. Still, you can get and use
           other category values at the same time through the normal API for
           flexibility.
           <!--l. 2098--><p class="noindent" >dzlog_init() is just as zlog_init(), but needs a <span class="uline">cname</span> for the internal default
           category. zlog_reload() and zlog_fini() can be used as before, to refresh
           conf_file, or release all.
           <!--l. 2102--><p class="noindent" >dzlog_set_category() is designed for changing the default category. The
           last default category is replaced by the new one. Don&#8217;t worry about
           releasing memory since all category allocations will be cleaned up at
           zlog_fini().
           <!--l. 2107--><p class="noindent" >Macros are defined in zlog.h. They are the general way in simple
           logging.
           <!--l. 2108--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2108--><p class="noindent" ><span 
class="ectt-1200">dzlog_fatal(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2111--><p class="noindent" ><span 
class="ectt-1200">dzlog_error(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2113--><p class="noindent" ><span 
class="ectt-1200">dzlog_warn(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2115--><p class="noindent" ><span 
class="ectt-1200">dzlog_notice(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2117--><p class="noindent" ><span 
class="ectt-1200">dzlog_info(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2119--><p class="noindent" ><span 
class="ectt-1200">dezlog_debug(format,</span><span 
class="ectt-1200">&#x00A0;...)</span>
                <!--l. 2121--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2123--><p class="noindent" ><span 
class="ectt-1200">vdzlog_fatal(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2125--><p class="noindent" ><span 
class="ectt-1200">vdzlog_error(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2127--><p class="noindent" ><span 
class="ectt-1200">vdzlog_warn(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2129--><p class="noindent" ><span 
class="ectt-1200">vdzlog_notice(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2131--><p class="noindent" ><span 
class="ectt-1200">vdzlog_info(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2133--><p class="noindent" ><span 
class="ectt-1200">vdzlog_debug(format,</span><span 
class="ectt-1200">&#x00A0;args)</span>
                <!--l. 2135--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2137--><p class="noindent" ><span 
class="ectt-1200">hdzlog_fatal(buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2139--><p class="noindent" ><span 
class="ectt-1200">hdzlog_error(buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2141--><p class="noindent" ><span 
class="ectt-1200">hdzlog_warn(buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                                                                                  
                                                                                  
                <!--l. 2143--><p class="noindent" ><span 
class="ectt-1200">hdzlog_noticebuf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2145--><p class="noindent" ><span 
class="ectt-1200">hdzlog_info(buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span>
                <!--l. 2147--><p class="noindent" ><span 
class="ectt-1200">hdzlog_debug(buf,</span><span 
class="ectt-1200">&#x00A0;buf_len)</span></dd></dl>
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 2149--><p class="noindent" >VALUE
           <!--l. 2151--><p class="noindent" >On success, dzlog_init() and dzlog_set_category() return zero. On error,
           dzlog_init() and dzlog_set_category() return -1, and a detailed error log will
           be recorded to the log file indicated by ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 2157--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.6   </span> <a 
 id="x1-350006.6"></a>User-defined Output</h3>
<!--l. 2158--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 2159--><p class="noindent" >
           <!--l. 2161--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2161--><p class="noindent" ><span 
class="ectt-1200">typedef</span><span 
class="ectt-1200">&#x00A0;struct</span><span 
class="ectt-1200">&#x00A0;zlog_msg_s</span><span 
class="ectt-1200">&#x00A0;{</span>
                <!--l. 2164--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*buf;</span>
                <!--l. 2166--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;size_t</span><span 
class="ectt-1200">&#x00A0;len;</span>
                <!--l. 2168--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*path;</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2170--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;zlog_msg_t;</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2172--><p class="noindent" ><span 
class="ectt-1200">typedef</span><span 
class="ectt-1200">&#x00A0;int</span><span 
class="ectt-1200">&#x00A0;(*zlog_record_fn)(zlog_msg_t</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">msg</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span>
                <!--l. 2174--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;zlog_set_record(const</span><span 
class="ectt-1200">&#x00A0;char</span><span 
class="ectt-1200">&#x00A0;*</span><span class="uline"><span 
class="ectt-1200">rname</span></span><span 
class="ectt-1200">,</span><span 
class="ectt-1200">&#x00A0;zlog_record_fn</span><span 
class="ectt-1200">&#x00A0;</span><span class="uline"><span 
class="ectt-1200">record</span></span><span 
class="ectt-1200">);</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 2176--><p class="noindent" >
                                                                                  
                                                                                  
           <!--l. 2178--><p class="noindent" >zlog allows a user to define an output function. The output function
           bonds to a special kind of rule in configuration file. A typical rule
           is:
           <!--l. 2181--><p class="noindent" >
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2181--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;$name,</span><span 
class="ectt-1200">&#x00A0;"record</span><span 
class="ectt-1200">&#x00A0;path</span><span 
class="ectt-1200">&#x00A0;%c</span><span 
class="ectt-1200">&#x00A0;%d";</span><span 
class="ectt-1200">&#x00A0;simple</span></dd></dl>
           <!--l. 2184--><p class="noindent" >zlog_set_record() does the bonding operation. Rules with the $<span class="uline">rname</span> will be
           output through user-defined function <span class="uline">record</span>. The callback function has the
           type of zlog_record_fn.
           <!--l. 2188--><p class="noindent" >The members of struct zlog_msg_t are decribed below:
           <!--l. 2190--><p class="noindent" ><span class="uline">path</span> comes from the second parameter of rule after $name, which is generated
           dynamically like the file path.
           <!--l. 2193--><p class="noindent" ><span class="uline">buf</span> and <span class="uline">len</span> are zlog formatted log message and its length.
           <!--l. 2196--><p class="noindent" >All settings of zlog_set_record() are kept available after zlog_reload().
           </dd><dt class="list">
RETURN  </dt><dd 
class="list">
           <!--l. 2197--><p class="noindent" >VALUE
           <!--l. 2199--><p class="noindent" >On success, zlog_set_record() returns zero. On error, it returns -1,
           and a detailed error log will be recorded to the log file indicated by
           ZLOG_PROFILE_ERROR.</dd></dl>
<!--l. 2204--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">6.7   </span> <a 
 id="x1-360006.7"></a>debug and profile</h3>
<!--l. 2205--><p class="noindent" >
           <dl class="list1"><dt class="list">
SYNOPSIS </dt><dd 
class="list">
           <!--l. 2206--><p class="noindent" >
           <!--l. 2208--><p class="noindent" >
                                                                                  
                                                                                  
                <dl class="list2"><dt class="list">
                </dt><dd 
class="list">
                <!--l. 2208--><p class="noindent" ><span 
class="ectt-1200">void</span><span 
class="ectt-1200">&#x00A0;zlog_profile(void);</span></dd></dl>
           </dd><dt class="list">
DESCRIPTION </dt><dd 
class="list">
           <!--l. 2211--><p class="noindent" >
           <!--l. 2213--><p class="noindent" >environment variable ZLOG_PROFILE_ERROR indicates zlog&#8217;s error log
           path.
           <!--l. 2216--><p class="noindent" >environment variable ZLOG_PROFILE_DEBUG indicates zlog&#8217;s debug log
           path.
           <!--l. 2219--><p class="noindent" >zlog_profile() prints all information in memory to zlog&#8217;s error log file at
           runtime. You can compare it to the configuration file to find possible
           errors.</dd></dl>
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-370007"></a>Advanced Usage</h2>
   <h3 class="sectionHead"><span class="titlemark">7.1   </span> <a 
 id="x1-380007.1"></a>MDC</h3>
<!--l. 2228--><p class="noindent" >What is MDC? In log4j it is short for Mapped Diagnostic Context. That sounds like a
complicated terminology. MDC is just a key-value map. Once you set it by function, the
zlog library will print it to file every time a log event happens, or become part of log file
path. Let&#8217;s see an example in $(top_builddir)/test/test_mdc.c.
<!--l. 2233--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2233--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;test_mdc.c</span>
      <!--l. 2236--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span>
      <!--l. 2238--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdlib.h&#x003E;</span>
      <!--l. 2240--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;sys/types.h&#x003E;</span>
      <!--l. 2242--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;unistd.h&#x003E;</span>
      <!--l. 2244--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;string.h&#x003E;</span>
      <!--l. 2246--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
      <!--l. 2248--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
      <!--l. 2250--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2252--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2252--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
           <!--l. 2255--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*zc;</span>
           <!--l. 2257--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_init("test_mdc.conf");</span>
           <!--l. 2259--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2261--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2261--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
               <!--l. 2264--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
           <!--l. 2266--><p class="noindent" ><span 
class="ectt-1200">}</span>
           <!--l. 2268--><p class="noindent" ><span 
class="ectt-1200">zc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span>
           <!--l. 2270--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(!zc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
                                                                                  
                                                                                  
           <!--l. 2272--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2272--><p class="noindent" ><span 
class="ectt-1200">printf("get</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;fail\n");</span>
               <!--l. 2275--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
               <!--l. 2277--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-2;</span></dd></dl>
           <!--l. 2279--><p class="noindent" ><span 
class="ectt-1200">}</span>
           <!--l. 2281--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"1.hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
           <!--l. 2283--><p class="noindent" ><span 
class="ectt-1200">zlog_put_mdc("myname",</span><span 
class="ectt-1200">&#x00A0;"Zhang");</span>
           <!--l. 2285--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"2.hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
           <!--l. 2287--><p class="noindent" ><span 
class="ectt-1200">zlog_put_mdc("myname",</span><span 
class="ectt-1200">&#x00A0;"Li");</span>
           <!--l. 2289--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"3.hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2291--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2293--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
      <!--l. 2295--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
<!--l. 2297--><p class="noindent" >The configure file is
<!--l. 2298--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2298--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;test_mdc.conf</span>
      <!--l. 2301--><p class="noindent" ><span 
class="ectt-1200">[formats]</span>
      <!--l. 2303--><p class="noindent" ><span 
class="ectt-1200">mdc_format=</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%d.%ms</span><span 
class="ectt-1200">&#x00A0;%-6V</span><span 
class="ectt-1200">&#x00A0;(%c:%F:%L)</span><span 
class="ectt-1200">&#x00A0;[%M(myname)]</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;%m%n"</span>
      <!--l. 2305--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 2307--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;mdc_format</span></dd></dl>
<!--l. 2309--><p class="noindent" >And the output is
<!--l. 2310--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2310--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;./test_mdc</span>
      <!--l. 2313--><p class="noindent" ><span 
class="ectt-1200">2012-03-12</span><span 
class="ectt-1200">&#x00A0;09:26:37.740</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(my_cat:test_mdc.c:47)</span><span 
class="ectt-1200">&#x00A0;[]</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;1.hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2315--><p class="noindent" ><span 
class="ectt-1200">2012-03-12</span><span 
class="ectt-1200">&#x00A0;09:26:37.740</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(my_cat:test_mdc.c:51)</span><span 
class="ectt-1200">&#x00A0;[Zhang]</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;2.hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2317--><p class="noindent" ><span 
class="ectt-1200">2012-03-12</span><span 
class="ectt-1200">&#x00A0;09:26:37.740</span><span 
class="ectt-1200">&#x00A0;INFO</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(my_cat:test_mdc.c:55)</span><span 
class="ectt-1200">&#x00A0;[Li]</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;3.hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 2319--><p class="noindent" >You can see zlog_put_mdc() function sets the map with key "myname" and value "Zhang",
and in configuration file <span 
class="ecti-1200">%M(myname) </span>indicates where the value shows in each log. The
second time, value of key "myname" is overwritten to "Li", and the log changes
also.
<!--l. 2326--><p class="indent" >   When should MDC be used? That mainly depends on when a user need to separate
same log action with different scenarios. For example, in .c
<!--l. 2329--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2329--><p class="noindent" ><span 
class="ectt-1200">zlog_put_mdc("customer_name",</span><span 
class="ectt-1200">&#x00A0;get_customer_name_from_db()</span><span 
class="ectt-1200">&#x00A0;);</span>
      <!--l. 2332--><p class="noindent" ><span 
class="ectt-1200">zlog_info("get</span><span 
class="ectt-1200">&#x00A0;in");</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2334--><p class="noindent" ><span 
class="ectt-1200">zlog_info("pick</span><span 
class="ectt-1200">&#x00A0;product");</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2336--><p class="noindent" ><span 
class="ectt-1200">zlog_info("pay");</span>
      <!--l. 2338--><p class="noindent" ><span 
class="ectt-1200">zlog_info("get</span><span 
class="ectt-1200">&#x00A0;out");</span></dd></dl>
<!--l. 2340--><p class="noindent" >in .conf
<!--l. 2341--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2341--><p class="noindent" ><span 
class="ectt-1200">&amp;format</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%M(customer_name)</span><span 
class="ectt-1200">&#x00A0;%m%n"</span></dd></dl>
<!--l. 2344--><p class="noindent" >When the program processes two customers at the same time, the output could
be:
<!--l. 2346--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2346--><p class="noindent" ><span 
class="ectt-1200">Zhang</span><span 
class="ectt-1200">&#x00A0;get</span><span 
class="ectt-1200">&#x00A0;in</span>
      <!--l. 2349--><p class="noindent" ><span 
class="ectt-1200">Li</span><span 
class="ectt-1200">&#x00A0;get</span><span 
class="ectt-1200">&#x00A0;in</span>
      <!--l. 2351--><p class="noindent" ><span 
class="ectt-1200">Zhang</span><span 
class="ectt-1200">&#x00A0;pick</span><span 
class="ectt-1200">&#x00A0;product</span>
      <!--l. 2353--><p class="noindent" ><span 
class="ectt-1200">Zhang</span><span 
class="ectt-1200">&#x00A0;pay</span>
      <!--l. 2355--><p class="noindent" ><span 
class="ectt-1200">Li</span><span 
class="ectt-1200">&#x00A0;pick</span><span 
class="ectt-1200">&#x00A0;product</span>
      <!--l. 2357--><p class="noindent" ><span 
class="ectt-1200">Li</span><span 
class="ectt-1200">&#x00A0;pay</span>
      <!--l. 2359--><p class="noindent" ><span 
class="ectt-1200">Zhang</span><span 
class="ectt-1200">&#x00A0;get</span><span 
class="ectt-1200">&#x00A0;out</span>
      <!--l. 2361--><p class="noindent" ><span 
class="ectt-1200">Li</span><span 
class="ectt-1200">&#x00A0;get</span><span 
class="ectt-1200">&#x00A0;out</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 2363--><p class="noindent" >Now you can distinguish one customer from another, by using grep afterwards
<!--l. 2364--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2364--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;grep</span><span 
class="ectt-1200">&#x00A0;Zhang</span><span 
class="ectt-1200">&#x00A0;aa.log</span><span 
class="ectt-1200">&#x00A0;&#x003E;</span><span 
class="ectt-1200">&#x00A0;Zhang.log</span>
      <!--l. 2367--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;grep</span><span 
class="ectt-1200">&#x00A0;Li</span><span 
class="ectt-1200">&#x00A0;aa.log</span><span 
class="ectt-1200">&#x00A0;&#x003E;Li.log</span></dd></dl>
<!--l. 2369--><p class="noindent" >Or, another way is to seperate them to different log file when log action is taken. In
.conf
<!--l. 2371--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2371--><p class="noindent" ><span 
class="ectt-1200">*.*</span><span 
class="ectt-1200">&#x00A0;"mdc_%M(customer_name).log";</span></dd></dl>
<!--l. 2374--><p class="noindent" >It will produce 3 logs
<!--l. 2375--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2375--><p class="noindent" ><span 
class="ectt-1200">mdc_.log</span><span 
class="ectt-1200">&#x00A0;mdc_Zhang.log</span><span 
class="ectt-1200">&#x00A0;mdc_Li.log</span></dd></dl>
<!--l. 2378--><p class="noindent" >That&#8217;s a quick way, if you know what you are doing.
<!--l. 2380--><p class="indent" >   In MDC, the map belongs to a thread and each thread has it&#8217;s own map. In one
thread zlog_mdc_put() will not affect other thread&#8217;s map. Still, if you want
to distinguish one thread from another, using the %t conversion character is
enough.
<!--l. 2384--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2384--><p class="noindent" >
      </dd></dl>
                                                                                  
                                                                                  
<!--l. 2388--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-390007.2"></a>Profile zlog Itself</h3>
<!--l. 2390--><p class="noindent" >Until this point we have assumed that the zlog library never fails. It helps the application
to write log entries and to debug the application. But if zlog itself has some problem, how
can we find out? Other programs debug through the log library so how can a
log library debug itself? The answer is the same, zlog library has its own log.
This profile log is usually closed, and can be opened by setting environment
variables.
<!--l. 2396--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2396--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;export</span><span 
class="ectt-1200">&#x00A0;ZLOG_PROFILE_DEBUG=/tmp/zlog.debug.log</span>
      <!--l. 2399--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;export</span><span 
class="ectt-1200">&#x00A0;ZLOG_PROFILE_ERROR=/tmp/zlog.error.log</span></dd></dl>
<!--l. 2401--><p class="noindent" >profile log has just 2 levels, debug and error. After setting them, run test_hello program in
<a 
href="#x1-90003.3">3.3<!--tex4ht:ref: sec:Hello-World-Example --></a>, and the debug log will be
<!--l. 2404--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2404--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;more</span><span 
class="ectt-1200">&#x00A0;zlog.debug.log</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2407--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;09:46:56</span><span 
class="ectt-1200">&#x00A0;DEBUG</span><span 
class="ectt-1200">&#x00A0;(7503:zlog.c:115)</span><span 
class="ectt-1200">&#x00A0;------zlog_init</span><span 
class="ectt-1200">&#x00A0;start,</span><span 
class="ectt-1200">&#x00A0;compile</span><span 
class="ectt-1200">&#x00A0;time[Mar</span><span 
class="ectt-1200">&#x00A0;13</span><span 
class="ectt-1200">&#x00A0;2012</span><span 
class="ectt-1200">&#x00A0;11:28:56]------</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2409--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;09:46:56</span><span 
class="ectt-1200">&#x00A0;DEBUG</span><span 
class="ectt-1200">&#x00A0;(7503:spec.c:825)</span><span 
class="ectt-1200">&#x00A0;spec:[0x7fdf96b7c010][%d(%F</span><span 
class="ectt-1200">&#x00A0;%T)][%F</span><span 
class="ectt-1200">&#x00A0;%T</span><span 
class="ectt-1200">&#x00A0;29][]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2411--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;09:46:56</span><span 
class="ectt-1200">&#x00A0;DEBUG</span><span 
class="ectt-1200">&#x00A0;(7503:spec.c:825)</span><span 
class="ectt-1200">&#x00A0;spec:[0x7fdf96b52010][</span><span 
class="ectt-1200">&#x00A0;][</span><span 
class="ectt-1200">&#x00A0;0][]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2413--><p class="noindent" ><span 
class="ectt-1200">......</span>
      <!--l. 2415--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;09:52:40</span><span 
class="ectt-1200">&#x00A0;DEBUG</span><span 
class="ectt-1200">&#x00A0;(8139:zlog.c:291)</span><span 
class="ectt-1200">&#x00A0;------zlog_fini</span><span 
class="ectt-1200">&#x00A0;end------</span></dd></dl>
<!--l. 2417--><p class="noindent" >zlog.error.log is not created, as no error occurs.
<!--l. 2419--><p class="indent" >   As you can see, debug log shows how zlog is inited and finished, but no debug log is
written when zlog_info() is executed. That&#8217;s for efficency.
<!--l. 2423--><p class="indent" >   If there is anything wrong with zlog library, all will show in zlog.error.log. For example,
using a wrong printf syntax in zlog()
<!--l. 2425--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2425--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"%l",</span><span 
class="ectt-1200">&#x00A0;1);</span></dd></dl>
                                                                                  
                                                                                  
<!--l. 2428--><p class="noindent" >Then run the program, the zlog.error.log should be
<!--l. 2429--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2429--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;zlog.error.log</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2432--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:buf.c:189)</span><span 
class="ectt-1200">&#x00A0;vsnprintf</span><span 
class="ectt-1200">&#x00A0;fail,</span><span 
class="ectt-1200">&#x00A0;errno[0]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2434--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:buf.c:191)</span><span 
class="ectt-1200">&#x00A0;nwrite[-1],</span><span 
class="ectt-1200">&#x00A0;size_left[1024],</span><span 
class="ectt-1200">&#x00A0;format[%l]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2436--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:spec.c:329)</span><span 
class="ectt-1200">&#x00A0;zlog_buf_vprintf</span><span 
class="ectt-1200">&#x00A0;maybe</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;or</span><span 
class="ectt-1200">&#x00A0;overflow</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2438--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:spec.c:467)</span><span 
class="ectt-1200">&#x00A0;a_spec-&#x003E;gen_buf</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2440--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:format.c:160)</span><span 
class="ectt-1200">&#x00A0;zlog_spec_gen_msg</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2442--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:rule.c:265)</span><span 
class="ectt-1200">&#x00A0;zlog_format_gen_msg</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2444--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:category.c:164)</span><span 
class="ectt-1200">&#x00A0;hzb_log_rule_output</span><span 
class="ectt-1200">&#x00A0;fail</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2446--><p class="noindent" ><span 
class="ectt-1200">03-13</span><span 
class="ectt-1200">&#x00A0;10:04:58</span><span 
class="ectt-1200">&#x00A0;ERROR</span><span 
class="ectt-1200">&#x00A0;(10102:zlog.c:632)</span><span 
class="ectt-1200">&#x00A0;zlog_output</span><span 
class="ectt-1200">&#x00A0;fail,</span><span 
class="ectt-1200">&#x00A0;srcfile[test_hello.c],</span><span 
class="ectt-1200">&#x00A0;srcline[41]</span></dd></dl>
<!--l. 2448--><p class="noindent" >Now, you could find the reason why the expected log doesn&#8217;t generate, and fix the wrong
printf syntax.
<!--l. 2451--><p class="indent" >   Runtime profiling causes a loss of efficency. Normally, I keep ZLOG_PROFILE_ERROR
on and ZLOG_PROFILE_DEBUG off in my environment.
<!--l. 2454--><p class="indent" >   There is another way to profile the zlog library. zlog_init() reads the configuration file
into memory. Throughout all log actions, the configure structure remains unchanged.
There is possibility that this memory is damaged by other functions in an application, or
the memory doesn&#8217;t equal what the configuration file describes. So there is a function to
show this memory at runtime and print it to ZLOG_PROFILE_ERROR.
<!--l. 2461--><p class="indent" >   see $(top_builddir)/test/test_profile.c
<!--l. 2462--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2462--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;test_profile.c</span>
      <!--l. 2465--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span>
      <!--l. 2467--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
      <!--l. 2469--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2471--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
      <!--l. 2473--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2475--><p class="noindent" >
           <dl class="list2"><dt class="list">
                                                                                  
                                                                                  
           </dt><dd 
class="list">
           <!--l. 2475--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
           <!--l. 2478--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;dzlog_init("test_profile.conf",</span><span 
class="ectt-1200">&#x00A0;"my_cat");</span>
           <!--l. 2480--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2482--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2482--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
               <!--l. 2485--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
           <!--l. 2487--><p class="noindent" ><span 
class="ectt-1200">}</span>
           <!--l. 2489--><p class="noindent" ><span 
class="ectt-1200">dzlog_info("hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
           <!--l. 2491--><p class="noindent" ><span 
class="ectt-1200">zlog_profile();</span>
           <!--l. 2493--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2495--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
      <!--l. 2497--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
<!--l. 2499--><p class="noindent" >zlog_profile() is the function. The configuration file is simple
<!--l. 2500--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2500--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;test_profile.conf</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2503--><p class="noindent" ><span 
class="ectt-1200">[formats]</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2505--><p class="noindent" ><span 
class="ectt-1200">simple</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%m%n"</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2507--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
      <!--l. 2509--><p class="noindent" ><span 
class="ectt-1200">my_cat.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;simple</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
<!--l. 2511--><p class="noindent" >Then zlog.error.log is
<!--l. 2512--><p class="noindent" >
      <dl class="list1"><dt class="list">
      </dt><dd 
class="list">
      <!--l. 2512--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;/tmp/zlog.error.log</span>
      <!--l. 2515--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:zlog.c:783)</span><span 
class="ectt-1200">&#x00A0;------zlog_profile</span><span 
class="ectt-1200">&#x00A0;start------</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2517--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:zlog.c:784)</span><span 
class="ectt-1200">&#x00A0;init_flag:[1]</span><span 
class="ectt-1200">&#x00A0;</span>
                                                                                  
                                                                                  
      <!--l. 2519--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:75)</span><span 
class="ectt-1200">&#x00A0;-conf[0x2333010]-</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2521--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:76)</span><span 
class="ectt-1200">&#x00A0;--global--</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2523--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:77)</span><span 
class="ectt-1200">&#x00A0;---file[test_profile.conf],mtime[2012-06-01</span><span 
class="ectt-1200">&#x00A0;11:20:44]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2525--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:78)</span><span 
class="ectt-1200">&#x00A0;---strict</span><span 
class="ectt-1200">&#x00A0;init[1]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2527--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:79)</span><span 
class="ectt-1200">&#x00A0;---buffer</span><span 
class="ectt-1200">&#x00A0;min[1024]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2529--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:80)</span><span 
class="ectt-1200">&#x00A0;---buffer</span><span 
class="ectt-1200">&#x00A0;max[2097152]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2531--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:82)</span><span 
class="ectt-1200">&#x00A0;---default_format---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2533--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:format.c:48)</span><span 
class="ectt-1200">&#x00A0;---format[0x235ef60][default</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;%d(%F</span><span 
class="ectt-1200">&#x00A0;%T)</span><span 
class="ectt-1200">&#x00A0;%V</span><span 
class="ectt-1200">&#x00A0;[%p:%F:%L]</span><span 
class="ectt-1200">&#x00A0;%m%n(0x233b810)]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2535--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:85)</span><span 
class="ectt-1200">&#x00A0;---file</span><span 
class="ectt-1200">&#x00A0;perms[0600]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2537--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:conf.c:87)</span><span 
class="ectt-1200">&#x00A0;---rotate</span><span 
class="ectt-1200">&#x00A0;lock</span><span 
class="ectt-1200">&#x00A0;file[/tmp/zlog.lock]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2539--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:rotater.c:48)</span><span 
class="ectt-1200">&#x00A0;--rotater[0x233b7d0][0x233b7d0,/tmp/zlog.lock,4]--</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2541--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level_list.c:37)</span><span 
class="ectt-1200">&#x00A0;--level_list[0x2335490]--</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2543--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x23355c0][0,*,*,1,6]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2545--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x23375e0][20,DEBUG,debug,5,7]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2547--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x2339600][40,INFO,info,4,6]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2549--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x233b830][60,NOTICE,notice,6,5]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2551--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x233d850][80,WARN,warn,4,4]---</span><span 
class="ectt-1200">&#x00A0;</span>
      <!--l. 2553--><p class="noindent" ><span 
class="ectt-1200">06-01</span><span 
class="ectt-1200">&#x00A0;11:21:26</span><span 
class="ectt-1200">&#x00A0;WARN</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;(7063:level.c:37)</span><span 
class="ectt-1200">&#x00A0;---level[0x233fc80][100,ERROR,error,5,3]---</span></dd></dl>
<!--l. 2556--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-400007.3"></a>User-defined Level</h3>
<!--l. 2558--><p class="noindent" >Here are all the steps to define your own levels.
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-40002x1">Define levels in the configuration file.
      <!--l. 2562--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2562--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;$(top_builddir)/test/test_level.conf</span>
           <!--l. 2565--><p class="noindent" ><span 
class="ectt-1200">[global]</span>
           <!--l. 2567--><p class="noindent" ><span 
class="ectt-1200">default</span><span 
class="ectt-1200">&#x00A0;format</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;"%V</span><span 
class="ectt-1200">&#x00A0;%v</span><span 
class="ectt-1200">&#x00A0;%m%n"</span>
           <!--l. 2569--><p class="noindent" ><span 
class="ectt-1200">[levels]</span>
           <!--l. 2571--><p class="noindent" ><span 
class="ectt-1200">TRACE</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;30,</span><span 
class="ectt-1200">&#x00A0;LOG_DEBUG</span>
           <!--l. 2573--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
           <!--l. 2575--><p class="noindent" ><span 
class="ectt-1200">my_cat.TRACE</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;&#x003E;stdout;</span></dd></dl>
                                                                                  
                                                                                  
      <!--l. 2577--><p class="noindent" >The internal default levels are (no need to write them in the conf file):
      <!--l. 2579--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2579--><p class="noindent" ><span 
class="ectt-1200">DEBUG</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;20,</span><span 
class="ectt-1200">&#x00A0;LOG_DEBUG</span>
           <!--l. 2582--><p class="noindent" ><span 
class="ectt-1200">INFO</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;40,</span><span 
class="ectt-1200">&#x00A0;LOG_INFO</span>
           <!--l. 2584--><p class="noindent" ><span 
class="ectt-1200">NOTICE</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;60,</span><span 
class="ectt-1200">&#x00A0;LOG_NOTICE</span>
           <!--l. 2586--><p class="noindent" ><span 
class="ectt-1200">WARN</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;80,</span><span 
class="ectt-1200">&#x00A0;LOG_WARNING</span>
           <!--l. 2588--><p class="noindent" ><span 
class="ectt-1200">ERROR</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;100,</span><span 
class="ectt-1200">&#x00A0;LOG_ERR</span>
           <!--l. 2590--><p class="noindent" ><span 
class="ectt-1200">FATAL</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;120,</span><span 
class="ectt-1200">&#x00A0;LOG_ALERT</span>
           <!--l. 2592--><p class="noindent" ><span 
class="ectt-1200">UNKNOWN</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;254,</span><span 
class="ectt-1200">&#x00A0;LOG_ERR</span></dd></dl>
      <!--l. 2594--><p class="noindent" >In zlog, an integer(30) and a level string(TRACE) represent a level. Note that this
      integer must be in [1,253], any other number is illegal. Higher numbers are more
      important. TRACE is more important than DEBUG(30&#x003E;20), and less important
      than INFO(30&#x003C;40). After the definition, TRACE can be used in rule of configure
      file. This sentence
      <!--l. 2599--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2599--><p class="noindent" ><span 
class="ectt-1200">my_cat.TRACE</span>
           <span 
class="ectt-1200">&#x003E;stdout;</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      <!--l. 2602--><p class="noindent" >means that level &#x003E;= TRACE, which is TRACE, INFO, NOTICE, WARN, ERROR,
      FATAL will be written to standard output.
      <!--l. 2605--><p class="noindent" >The conversion charactor %V of format string generates the uppercase
      value of the level string and %v generates the lowercase value of the level
      string.
      <!--l. 2609--><p class="noindent" >In the level definition LOG_DEBUG means when using &#x003E;syslog in a rule, all
      TRACE log will output as syslog&#8217; s LOG_DEBUG level.
      </li>
      <li 
  class="enumerate" id="x1-40004x2">Using the new log level in source file, the direct way is like this
      <!--l. 2613--><p class="noindent" >
                                                                                  
                                                                                  
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2613--><p class="noindent" ><span 
class="ectt-1200">zlog(cat,</span><span 
class="ectt-1200">&#x00A0;__FILE__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__FILE__)-1,</span><span 
class="ectt-1200">&#x00A0;\</span>
           <!--l. 2616--><p class="noindent" ><span 
class="ectt-1200">__func__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__func__)-1,__LINE__,</span><span 
class="ectt-1200">&#x00A0;\</span>
           <!--l. 2618--><p class="noindent" ><span 
class="ectt-1200">30,</span><span 
class="ectt-1200">&#x00A0;"test</span><span 
class="ectt-1200">&#x00A0;%d",</span><span 
class="ectt-1200">&#x00A0;1);</span></dd></dl>
      <!--l. 2620--><p class="noindent" >For easy use, create a .h file
      <!--l. 2621--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2621--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;$(top_builddir)/test/test_level.h</span>
           <!--l. 2624--><p class="noindent" ><span 
class="ectt-1200">#ifndef</span><span 
class="ectt-1200">&#x00A0;__test_level_h</span>
           <!--l. 2626--><p class="noindent" ><span 
class="ectt-1200">#define</span><span 
class="ectt-1200">&#x00A0;__test_level_h</span>
           <!--l. 2628--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2630--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
           <!--l. 2632--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2634--><p class="noindent" ><span 
class="ectt-1200">enum</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2636--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2636--><p class="noindent" ><span 
class="ectt-1200">ZLOG_LEVEL_TRACE</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;30,</span>
               <!--l. 2639--><p class="noindent" ><span 
class="ectt-1200">/*</span><span 
class="ectt-1200">&#x00A0;must</span><span 
class="ectt-1200">&#x00A0;equals</span><span 
class="ectt-1200">&#x00A0;conf</span><span 
class="ectt-1200">&#x00A0;file</span><span 
class="ectt-1200">&#x00A0;setting</span><span 
class="ectt-1200">&#x00A0;*/</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           <!--l. 2641--><p class="noindent" ><span 
class="ectt-1200">};</span>
           <!--l. 2643--><p class="noindent" ><span 
class="ectt-1200">#define</span><span 
class="ectt-1200">&#x00A0;zlog_trace(cat,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;...)</span><span 
class="ectt-1200">&#x00A0;\</span>
           <!--l. 2645--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;zlog(cat,</span><span 
class="ectt-1200">&#x00A0;__FILE__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__FILE__)-1,</span><span 
class="ectt-1200">&#x00A0;\</span>
           <!--l. 2647--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;__func__,</span><span 
class="ectt-1200">&#x00A0;sizeof(__func__)-1,</span><span 
class="ectt-1200">&#x00A0;__LINE__,</span><span 
class="ectt-1200">&#x00A0;\</span>
           <!--l. 2649--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;ZLOG_LEVEL_TRACE,</span><span 
class="ectt-1200">&#x00A0;format,</span><span 
class="ectt-1200">&#x00A0;##</span><span 
class="ectt-1200">&#x00A0;__VA_ARGS__)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2651--><p class="noindent" ><span 
class="ectt-1200">#endif</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-40006x3">Then zlog_trace can be used int .c file
      <!--l. 2655--><p class="noindent" >
           <dl class="list2"><dt class="list">
                                                                                  
                                                                                  
           </dt><dd 
class="list">
           <!--l. 2655--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;$(top_builddir)/test/test_level.c</span>
           <!--l. 2658--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2660--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"test_level.h"</span>
           <!--l. 2662--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
           <!--l. 2664--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2666--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2666--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
               <!--l. 2669--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*zc;</span>
               <!--l. 2671--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2673--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_init("test_level.conf");</span>
               <!--l. 2675--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2677--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 2677--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
                   <!--l. 2680--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
               <!--l. 2682--><p class="noindent" ><span 
class="ectt-1200">}</span>
               <!--l. 2684--><p class="noindent" ><span 
class="ectt-1200">zc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span>
               <!--l. 2686--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(!zc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2688--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 2688--><p class="noindent" ><span 
class="ectt-1200">printf("get</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;fail\n");</span>
                   <!--l. 2691--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
                   <!--l. 2693--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-2;</span></dd></dl>
               <!--l. 2695--><p class="noindent" ><span 
class="ectt-1200">}</span>
               <!--l. 2697--><p class="noindent" ><span 
class="ectt-1200">zlog_trace(zc,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;trace");</span>
               <!--l. 2699--><p class="noindent" ><span 
class="ectt-1200">zlog_debug(zc,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;debug");</span>
               <!--l. 2701--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;info");</span>
               <!--l. 2703--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2705--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
                                                                                  
                                                                                  
           <!--l. 2707--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-40008x4">Now we can see the output
      <!--l. 2711--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2711--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;./test_level</span>
           <!--l. 2714--><p class="noindent" ><span 
class="ectt-1200">TRACE</span><span 
class="ectt-1200">&#x00A0;trace</span><span 
class="ectt-1200">&#x00A0;hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;trace</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2716--><p class="noindent" ><span 
class="ectt-1200">INFO</span><span 
class="ectt-1200">&#x00A0;info</span><span 
class="ectt-1200">&#x00A0;hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span><span 
class="ectt-1200">&#x00A0;-</span><span 
class="ectt-1200">&#x00A0;info</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      <!--l. 2718--><p class="noindent" >That&#8217;s just what we expect. The configuration file only allows &#x003E;=TRACE ouput to
      screen. And %V and %v work as well.</li></ol>
<!--l. 2722--><p class="noindent" >
   <h3 class="sectionHead"><span class="titlemark">7.4   </span> <a 
 id="x1-410007.4"></a>User-defined Output</h3>
<!--l. 2724--><p class="noindent" >The goal of user-defined output is that zlog gives up some rights. zlog is only responsible
for generating path and message dynamically as per the user&#8217;s configuration, but leaves
the log output, rotate and cleanup actions for the user to specify. You can do what ever
you want by setting a function to special rules. Here are the steps to define your own
output function.
      <ol  class="enumerate1" >
      <li 
  class="enumerate" id="x1-41002x1">Define output in rules of configure file.
      <!--l. 2733--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2733--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;test_record.conf</span>
           <!--l. 2736--><p class="noindent" ><span 
class="ectt-1200">[formats]</span>
           <!--l. 2738--><p class="noindent" ><span 
class="ectt-1200">simple</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;"%m%n"</span>
           <!--l. 2740--><p class="noindent" ><span 
class="ectt-1200">[rules]</span>
           <!--l. 2742--><p class="noindent" ><span 
class="ectt-1200">my_cat.*</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;$myoutput,</span><span 
class="ectt-1200">&#x00A0;"</span><span 
class="ectt-1200">&#x00A0;mypath</span><span 
class="ectt-1200">&#x00A0;%c</span><span 
class="ectt-1200">&#x00A0;%d";simple</span></dd></dl>
                                                                                  
                                                                                  
      </li>
      <li 
  class="enumerate" id="x1-41004x2">Set an output function for myoutput, then use it
      <!--l. 2746--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2746--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;&#x003C;stdio.h&#x003E;</span>
           <!--l. 2749--><p class="noindent" ><span 
class="ectt-1200">#include</span><span 
class="ectt-1200">&#x00A0;"zlog.h"</span>
           <!--l. 2751--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;output(zlog_msg_t</span><span 
class="ectt-1200">&#x00A0;*msg)</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2753--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2755--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2755--><p class="noindent" ><span 
class="ectt-1200">printf("[mystd]:[%s][%s][%ld]\n",</span><span 
class="ectt-1200">&#x00A0;msg-&#x003E;path,</span><span 
class="ectt-1200">&#x00A0;msg-&#x003E;buf,</span><span 
class="ectt-1200">&#x00A0;(long)msg-&#x003E;len);</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2758--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
           <!--l. 2760--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2762--><p class="noindent" ><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2764--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;main(int</span><span 
class="ectt-1200">&#x00A0;argc,</span><span 
class="ectt-1200">&#x00A0;char**</span><span 
class="ectt-1200">&#x00A0;argv)</span>
           <!--l. 2766--><p class="noindent" ><span 
class="ectt-1200">{</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2768--><p class="noindent" >
               <dl class="list3"><dt class="list">
               </dt><dd 
class="list">
               <!--l. 2768--><p class="noindent" ><span 
class="ectt-1200">int</span><span 
class="ectt-1200">&#x00A0;rc;</span>
               <!--l. 2771--><p class="noindent" ><span 
class="ectt-1200">zlog_category_t</span><span 
class="ectt-1200">&#x00A0;*zc;</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2773--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 2773--><p class="noindent" ><span 
class="ectt-1200">rc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_init("test_record.conf");</span>
                   <!--l. 2776--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(rc)</span><span 
class="ectt-1200">&#x00A0;{</span>
                   <!--l. 2778--><p class="noindent" ><span 
class="ectt-1200">printf("init</span><span 
class="ectt-1200">&#x00A0;failed\n");</span>
                   <!--l. 2780--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-1;</span></dd></dl>
               <!--l. 2782--><p class="noindent" ><span 
class="ectt-1200">}</span>
               <!--l. 2784--><p class="noindent" ><span 
class="ectt-1200">zlog_set_record("myoutput",</span><span 
class="ectt-1200">&#x00A0;output);</span>
               <!--l. 2786--><p class="noindent" ><span 
class="ectt-1200">zc</span><span 
class="ectt-1200">&#x00A0;=</span><span 
class="ectt-1200">&#x00A0;zlog_get_category("my_cat");</span>
                                                                                  
                                                                                  
               <!--l. 2788--><p class="noindent" ><span 
class="ectt-1200">if</span><span 
class="ectt-1200">&#x00A0;(!zc)</span><span 
class="ectt-1200">&#x00A0;{</span><span 
class="ectt-1200">&#x00A0;</span>
               <!--l. 2790--><p class="noindent" >
                   <dl class="list4"><dt class="list">
                   </dt><dd 
class="list">
                   <!--l. 2790--><p class="noindent" ><span 
class="ectt-1200">printf("get</span><span 
class="ectt-1200">&#x00A0;cat</span><span 
class="ectt-1200">&#x00A0;fail\n");</span>
                   <!--l. 2793--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
                   <!--l. 2795--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;-2;</span></dd></dl>
               <!--l. 2797--><p class="noindent" ><span 
class="ectt-1200">}</span>
               <!--l. 2799--><p class="noindent" ><span 
class="ectt-1200">zlog_info(zc,</span><span 
class="ectt-1200">&#x00A0;"hello,</span><span 
class="ectt-1200">&#x00A0;zlog");</span>
               <!--l. 2801--><p class="noindent" ><span 
class="ectt-1200">zlog_fini();</span>
               <!--l. 2803--><p class="noindent" ><span 
class="ectt-1200">return</span><span 
class="ectt-1200">&#x00A0;0;</span></dd></dl>
           <!--l. 2805--><p class="noindent" ><span 
class="ectt-1200">}</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      </li>
      <li 
  class="enumerate" id="x1-41006x3">Now we can see how the user-defined output() works
      <!--l. 2809--><p class="noindent" >
           <dl class="list2"><dt class="list">
           </dt><dd 
class="list">
           <!--l. 2809--><p class="noindent" ><span 
class="ectt-1200">$</span><span 
class="ectt-1200">&#x00A0;./test_record</span><span 
class="ectt-1200">&#x00A0;</span><span 
class="ectt-1200">&#x00A0;</span>
           <!--l. 2812--><p class="noindent" ><span 
class="ectt-1200">[mystd]:[</span><span 
class="ectt-1200">&#x00A0;mypath</span><span 
class="ectt-1200">&#x00A0;my_cat</span><span 
class="ectt-1200">&#x00A0;2012-07-19</span><span 
class="ectt-1200">&#x00A0;11:01:12][hello,</span><span 
class="ectt-1200">&#x00A0;zlog</span>
           <!--l. 2814--><p class="noindent" ><span 
class="ectt-1200">][12]</span><span 
class="ectt-1200">&#x00A0;</span></dd></dl>
      <!--l. 2816--><p class="noindent" >As you can see, msglen is 12, and msg is formatted by zlog to contain a newline
      character.
      </li>
      <li 
  class="enumerate" id="x1-41008x4">There are many other things you can do with user-defined output functions. As one
      user(flw@newsmth.net) provided:
      <!--l. 2821--><p class="noindent" >
           <ol  class="enumerate2" >
           <li 
  class="enumerate" id="x1-41010x1">Log name is foo.log
           </li>
           <li 
  class="enumerate" id="x1-41012x2">If foo.log is larger than 100M, then generate a new logfile which contains
           all the contents of foo.log. And zlog truncates foo.log to 0 and re-appends
           to it when the next log happens.
                                                                                  
                                                                                  
           </li>
           <li 
  class="enumerate" id="x1-41014x3">When the time is over 5 minutes after last logging, even if foo.log is not
           larger than 100M, zlog still jumps to a new file.
           </li>
           <li 
  class="enumerate" id="x1-41016x4">The new file name should be defined by your own needs. For example add
           device number as prefix and time string as postfix.
           </li>
           <li 
  class="enumerate" id="x1-41018x5">You  might  compress  the  new  log  file  to  save  disk  space  and  network
           bandwidth.</li></ol>
      <!--l. 2833--><p class="noindent" >I wish him good luck trying to write such a function for multi-process or
      multi-thread cases!</li></ol>
                                                                                  
                                                                                  
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;8</span><br /><a 
 id="x1-420008"></a>Epilog</h2> <div class="verse">
         <!--l. 2838--><p class="noindent" > Here&#8217;s to alcohol, the cause of &#8211; and solution to &#8211; all life&#8217;s problems.
</div>
<div class="tabular"> <table id="TBL-8" class="tabular" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-8-1g"><col 
id="TBL-8-1"></colgroup><tr  
 style="vertical-align:baseline;" id="TBL-8-1-"><td  style="white-space:nowrap; text-align:left;" id="TBL-8-1-1"  
class="td11"> Homer Simpson  </td>                                                             </tr></table>
                                                                                  </div>
    
</body></html> 

                                                                                  


